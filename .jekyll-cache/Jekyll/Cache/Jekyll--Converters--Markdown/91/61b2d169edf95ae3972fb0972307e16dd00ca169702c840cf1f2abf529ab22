I"»<h2 id="classes">Classes</h2>

<p>In Scala, we do this by defining a <em>class</em> :</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span><span class="kt">Int</span><span class="o">){</span>
	<span class="k">def</span> <span class="nf">numer</span> <span class="k">=</span> <span class="n">x</span><span class="o">;</span>
	<span class="k">def</span> <span class="nf">denom</span> <span class="k">=</span> <span class="n">y</span>

<span class="o">}</span>
</code></pre></div></div>

<p>This definition introduces two entitiles:</p>

<ul>
  <li>
    <p>A new <em>type</em>, name Rational.</p>
  </li>
  <li>
    <p>A <em>constructor</em> Rational to create elements of this type.</p>
  </li>
</ul>

<p>Scala keeps the names of types and values in <em>different namespaces</em></p>

<p>So thereâ€™s no confict between the two definitions of Rational</p>

<h3 id="objects">Objects</h3>

<p>We call the elements of a class type <em>objects</em>.</p>

<p>We create an object by prefixing an application of the constructor of the class with the operator new.</p>

<ul>
  <li>Example:</li>
</ul>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>

</code></pre></div></div>

<h3 id="members-of-an-object">Members of an Object</h3>

<p>Objects of the class Rational have two <em>members</em>, numer and denom.</p>

<p>We select the members of an object with the infix operatorâ€™.â€™(like in Java).</p>

<ul>
  <li>Example</li>
</ul>

<pre><code class="language-Scala">
val x = new Rational(1,2)                 //&gt; x  : week3.Rational = week3.Rational@2c641e9a
x.numer                                         //&gt; res0: Int = 1
x.denom                                         //&gt; res1: Int = 2


</code></pre>

<h3 id="methods">Methods</h3>

<p>One can go further and also package functions operating on a data abstraction in the data abstraction itself.</p>

<p>Such functions are called <em>methods</em>.</p>

<ul>
  <li>Example</li>
</ul>

<p>Rational numbers now would have, in addition to the functions <em>numer</em> and <em>denom</em>, the functions <em>add,sub,mul,div,equal,toString</em></p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span><span class="kt">Int</span><span class="o">){</span>

	<span class="k">def</span> <span class="nf">numer</span> <span class="k">=</span> <span class="n">x</span>
	<span class="k">def</span> <span class="nf">denom</span> <span class="k">=</span> <span class="n">y</span>

	<span class="k">def</span> <span class="nf">add</span><span class="o">(</span><span class="n">that</span><span class="k">:</span><span class="kt">Rational</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">numer</span><span class="o">*</span><span class="nv">that</span><span class="o">.</span><span class="py">denom</span> <span class="o">+</span> <span class="n">denom</span><span class="o">*</span><span class="nv">that</span><span class="o">.</span><span class="py">numer</span><span class="o">,</span>
	 <span class="n">denom</span><span class="o">*</span><span class="nv">that</span><span class="o">.</span><span class="py">denom</span><span class="o">)</span>
	 
	 <span class="k">def</span> <span class="nf">neg</span><span class="k">:</span><span class="kt">Rational</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Rational</span><span class="o">(-</span><span class="n">numer</span><span class="o">,</span><span class="n">denom</span><span class="o">)</span>
	 
	 <span class="k">def</span> <span class="nf">sub</span><span class="o">(</span><span class="n">that</span><span class="k">:</span><span class="kt">Rational</span><span class="o">)</span> <span class="k">=</span> <span class="nf">add</span><span class="o">(</span><span class="nv">that</span><span class="o">.</span><span class="py">neg</span><span class="o">)</span>
	 
	 <span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="n">numer</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">denom</span>
<span class="o">}</span>

</code></pre></div></div>

<h2 id="2-6-more-fun-with-rationals">2-6: More Fun With Rationals</h2>

<p>###Rationals with Data Abstraction</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span><span class="kt">Int</span><span class="o">){</span>

	<span class="k">def</span> <span class="nf">numer</span> <span class="k">=</span> <span class="n">x</span><span class="o">/</span><span class="n">g</span>
	<span class="k">def</span> <span class="nf">denom</span> <span class="k">=</span> <span class="n">y</span><span class="o">/</span><span class="n">g</span>
	
	<span class="k">private</span> <span class="k">def</span> <span class="nf">gcd</span><span class="o">(</span><span class="n">a</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="nf">if</span> <span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">a</span> <span class="k">else</span> <span class="nf">gcd</span><span class="o">(</span><span class="n">b</span><span class="o">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="o">)</span>
	 
	<span class="k">private</span> <span class="k">val</span> <span class="nv">g</span> <span class="k">=</span> <span class="nf">gcd</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span>
	 
	<span class="o">...</span>
	
<span class="o">}</span>
</code></pre></div></div>

<p>å®šä¹‰ç§æœ‰æˆå‘˜<code class="highlighter-rouge">g</code>å’Œç§æœ‰å‡½æ•°<code class="highlighter-rouge">gcd</code></p>

<p>It is equally possible to turn number and denom into vals, so that they are computed only once:</p>

<pre><code class="language-Scala">
class Rational(x:Int, y:Int){

	val numer = x/gcd(x,y)
	val denom = y/gcd(x,y)
	
	...
}

</code></pre>

<p>è¿™ç§ä¼˜åŒ–å’Œæ”¹åŠ¨éƒ½åœ¨è¿™ä¸ªç±»çš„é‡Œé¢ï¼Œå¹¶ä¸å½±å“è°ƒç”¨è€…ï¼Œè¿™ç§å¯¹æ•°æ®çš„å°è£…æˆä¸º<em>data abstraction</em></p>

<h3 id="self-reference">Self Reference</h3>

<p>On the inside of a class, the name <code class="highlighter-rouge">this</code> represents the object on which the current method is executed.</p>

<ul>
  <li>Example:</li>
</ul>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span><span class="kt">Int</span><span class="o">){</span>

<span class="o">...</span>

<span class="k">def</span> <span class="nf">less</span><span class="o">(</span><span class="n">that</span><span class="k">:</span><span class="kt">Rational</span><span class="o">)</span> <span class="k">=</span> <span class="n">numer</span> <span class="o">*</span> <span class="nv">that</span><span class="o">.</span><span class="py">denom</span> <span class="o">&lt;</span> <span class="nv">that</span><span class="o">.</span><span class="py">numer</span> <span class="o">*</span> <span class="n">denom</span>

<span class="k">def</span> <span class="nf">max</span><span class="o">(</span><span class="n">that</span><span class="k">:</span><span class="kt">Rational</span><span class="o">)</span> <span class="k">=</span> <span class="nf">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="py">less</span><span class="o">(</span><span class="n">that</span><span class="o">))</span> <span class="n">that</span> <span class="k">else</span> <span class="k">this</span>

<span class="o">...</span>	 
	 
<span class="o">}</span>
	

</code></pre></div></div>

<h3 id="precondition">Precondition</h3>

<p>å¯ä»¥åœ¨ç±»ä¸­åŠ å…¥å¯¹å‚æ•°çš„åˆæ³•æ€§æ ¡éªŒ:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span><span class="kt">Int</span><span class="o">){</span>

	<span class="nf">require</span><span class="o">(</span><span class="n">y</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">,</span> <span class="s">"denominator can not be 0"</span><span class="o">)</span>
	
	<span class="o">...</span>

<span class="o">}</span>

</code></pre></div></div>

<p><code class="highlighter-rouge">require</code> is a predefined function.</p>

<p>It takes a condition and an optional message string.</p>

<p>if the condition is false than <code class="highlighter-rouge">IllegalArgumentException</code> is thrown with the given message string.</p>

<h3 id="assertions">Assertions</h3>

<p>Besides <code class="highlighter-rouge">require</code>, there is also <code class="highlighter-rouge">assert</code></p>

<p>Assert also takes a condition and an optional message:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">val</span> <span class="nv">x</span> <span class="k">=</span> <span class="nf">sqrt</span><span class="o">(</span><span class="n">y</span><span class="o">)</span>
<span class="nf">assert</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span>

</code></pre></div></div>

<p>å’Œrequireä¸€æ ·ï¼Œassertåœ¨æ¡ä»¶ä¸ºfalseçš„æ—¶å€™ä¹Ÿä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯å¼‚å¸¸ç±»å‹ä¸º<code class="highlighter-rouge">AssertionError</code>ã€‚</p>

<p>assertå’Œrequireçš„ç›®çš„ä¸åŒï¼š</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">require</code> is used to enforce a precondition on the caller of a function.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">assert</code> is used as to check the code of the function itself.</p>
  </li>
</ul>

<h3 id="constructor">Constructor</h3>

<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒScalaçš„ç±»æœ‰é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œå¦‚æœæƒ³å¢åŠ æ„é€ å‡½æ•°ï¼Œéœ€è¦å°†<code class="highlighter-rouge">this</code>ä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Rational</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span><span class="kt">Int</span><span class="o">){</span>

	 <span class="nf">require</span><span class="o">(</span><span class="n">y</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">,</span> <span class="s">"denominator can not be 0"</span><span class="o">)</span>

	 <span class="k">def</span> <span class="nf">this</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nf">this</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="mi">1</span><span class="o">)</span>
	 
	 <span class="o">...</span>

<span class="o">}</span>

<span class="k">val</span> <span class="nv">z</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Rational</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>

</code></pre></div></div>

<h2 id="2-7-evaluations-and-operations">2-7: Evaluations and Operations</h2>

<h3 id="classes-and-substitutions">Classes and Substitutions</h3>

<p>æˆ‘ä»¬ä¹‹å‰å¯ä»¥ä½¿ç”¨substitutionè§„åˆ™å»åˆ†æå‡½æ•°ï¼Œè¿™èŠ‚å°†è¿™ä¸ªè§„åˆ™ç”¨äºclass object</p>

<ul>
  <li>
    <p><em>Question:</em> How is an instantiation of the class <code class="highlighter-rouge">new C(e1,...,em)</code></p>
  </li>
  <li>
    <p><em>Answer:</em> The expression arguments <code class="highlighter-rouge">e1,...,em</code> å‚æ•°å’Œå‡½æ•°å‡½æ•°ä¸€æ ·æ±‚å€¼ï¼Œå¾—åˆ°ï¼š<code class="highlighter-rouge">new C(v1,...,vm)</code></p>
  </li>
</ul>

<p>æˆ‘ä»¬ç°åœ¨å®šä¹‰è¿™æ ·ä¸€ä¸ªç±»:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class C(x1,...,xm){ ... def f(y1,...,yn) = b ...}

</code></pre></div></div>

<p>where:</p>

<ul>
  <li>
    <p>ç±»çš„æ„é€ å‡½æ•°å…¥å‚ä¸ºï¼š<code class="highlighter-rouge">x1,...,xn</code></p>
  </li>
  <li>
    <p>ç±»ä¸­å®šä¹‰ä¸ªäº†ä¸€ä¸ªå‡½æ•°<code class="highlighter-rouge">f</code>,å‚æ•°ä¸º<code class="highlighter-rouge">y1,...,yn</code></p>
  </li>
  <li>
    <p><em>Question:</em> How is the following expression evaluated?</p>
  </li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>new C(v1,...,vm).f(w1,...,wn)

</code></pre></div></div>

<h3 id="operators">Operators</h3>

<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ±‚ä¸¤ä¸ªæœ‰ç†æ•°çš„å’Œï¼Œä»£ç ä¸º<code class="highlighter-rouge">x.add(y)</code>ï¼Œè¿™ç§æ²¡æœ‰<code class="highlighter-rouge">x + y </code>ç›´è§‚ï¼Œå› æ­¤ï¼Œscalaæä¾›ä¸€ç§æ–¹å¼ä½¿æ–¹æ³•è°ƒç”¨å˜çš„æ›´ç›´è§‚ï¼š</p>

<p>å®ƒç”±ä¸¤éƒ¨åˆ†syntaxæ„æˆï¼š</p>

<ul>
  <li>Step1: Infix Notation:</li>
</ul>

<p>Any method with a parameter can be used like an infix operator.</p>

<p>it is therefore possible to write:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>r add s  	=&gt; 		r.add(s)

r less s 	=&gt; 		r.less(s)

r max s		=&gt;		r.max(s)

</code></pre></div></div>

<ul>
  <li>Step2: å®šä¹‰æ“ä½œç¬¦</li>
</ul>

<p>Scalaå¯ä»¥é‡è½½æ“ä½œç¬¦ï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
 <span class="k">def</span> <span class="nf">&lt;</span> <span class="o">(</span><span class="n">that</span><span class="k">:</span><span class="kt">Rational</span><span class="o">)</span> <span class="k">=</span> <span class="n">numer</span> <span class="o">*</span> <span class="nv">that</span><span class="o">.</span><span class="py">denom</span> <span class="o">&lt;</span> <span class="nv">that</span><span class="o">.</span><span class="py">numer</span> <span class="o">*</span> <span class="n">denom</span>
 
</code></pre></div></div>

<p>è°ƒç”¨å˜ä¸ºï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x.less(y)  ç­‰ä»·äº x &lt; y

</code></pre></div></div>

<h2 id="2-8-class-hierarchies">2-8: Class Hierarchies</h2>

<h3 id="abstract-classes">Abstract Classes</h3>

<p>Consider the task of writing a class for sets of integers with the following operations</p>

<p>å®šä¹‰ä¸€ä¸ªå¯ä»¥è¡¨ç¤ºæ•´æ•°é›†åˆçš„ç±»</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">IntSet</span><span class="o">{</span>

	<span class="k">def</span> <span class="nf">incl</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">InSet</span>
	<span class="k">def</span> <span class="nf">contains</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">Boolean</span>


<span class="o">}</span>


</code></pre></div></div>

<p>æŠ½è±¡ç±»:</p>

<p>IntSet is an <em>abstract class</em>.</p>

<p>æŠ½è±¡ç±»å¯ä»¥å®šä¹‰æ¥å£ï¼Œä½†ä¸éœ€è¦å®ç°ã€‚
æŠ½è±¡ç±»ä¸å¯ä»¥ç›´æ¥ç”¨<em>new</em>åˆ›å»º</p>

<h3 id="class-extensions">Class Extensions</h3>

<p>Letâ€™s consider implementing sets as binary trees.</p>

<p>There are two types of possible trees: a tree for the empty set, and a tree consisting of an integer and two sub-trees.</p>

<p>Here are their implementations</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Empty</span> <span class="k">extends</span> <span class="nc">IntSet</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">contains</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>
	
	<span class="k">def</span> <span class="nf">incl</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">IntSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NonEmpty</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="k">new</span> <span class="nc">Empty</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Empty</span><span class="o">)</span>

<span class="o">}</span>

<span class="k">class</span> <span class="nc">NonEmpty</span><span class="o">(</span><span class="n">elem</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">left</span><span class="k">:</span> <span class="kt">IntSet</span><span class="o">,</span> <span class="n">right</span><span class="k">:</span><span class="kt">IntSet</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">IntSet</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">contains</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">Boolean</span> <span class="o">=</span> 
	
		<span class="nf">if</span> <span class="o">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">elem</span><span class="o">)</span> <span class="nv">left</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
		<span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">elem</span><span class="o">)</span> <span class="nv">right</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
		<span class="k">else</span> <span class="kc">true</span>

	<span class="k">def</span> <span class="nf">incl</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">IntSet</span> <span class="o">=</span> 
		
		<span class="nf">if</span><span class="o">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">elem</span><span class="o">)</span> <span class="k">new</span> <span class="nc">NonEmpty</span><span class="o">(</span><span class="n">elem</span><span class="o">,</span><span class="nv">left</span><span class="o">.</span><span class="py">incl</span><span class="o">(</span><span class="n">x</span><span class="o">),</span> <span class="n">right</span><span class="o">)</span>
		<span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">elem</span><span class="o">)</span> <span class="k">new</span> <span class="nc">NonEmpty</span><span class="o">(</span><span class="n">elem</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="nv">right</span><span class="o">.</span><span class="py">incl</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
		<span class="k">else</span> <span class="k">this</span>

<span class="o">}</span>

</code></pre></div></div>

<p>###Base Classes and SubClasses</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">IntSet</code> is called the <em>superclass</em> of Empty and NonEmpty.</p>
  </li>
  <li>
    <p>Empty and NonEmpty are <em>subclasses</em> of <code class="highlighter-rouge">IntSet</code>.</p>
  </li>
  <li>
    <p>In Scala, any user-defined class extends another class.</p>
  </li>
  <li>
    <p>If no superclass is given , the standard class object in the Java package <code class="highlighter-rouge">java.lang</code> is assumed</p>
  </li>
  <li>
    <p>The direct or indirect superclasses of a class C are called <em>baseclasses</em> of C</p>
  </li>
  <li>
    <p>So, the base classes of NonEmpty are IntSet and Object</p>
  </li>
</ul>

<h3 id="implementing-and-overriding">Implementing and Overriding</h3>

<p>å¦‚æœçˆ¶ç±»ä¸­çš„æ–¹æ³•æ²¡æœ‰implementationï¼Œé‚£ä¹ˆå­ç±»å¯ç›´æ¥å®ç°ï¼Œå¦‚æœçˆ¶ç±»æ–¹æ³•ä¸­æœ‰implementationï¼Œé‚£ä¹ˆå­ç±»éœ€è¦overrideï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">abstract</span> <span class="k">class</span> <span class="nc">Base</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">foo</span> <span class="k">=</span> <span class="mi">1</span>
	
	<span class="k">def</span> <span class="nf">bar</span><span class="k">:</span><span class="kt">Int</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Sub</span> <span class="k">extends</span> <span class="nc">Base</span>
<span class="o">{</span>
	<span class="k">override</span> <span class="k">def</span> <span class="nf">foo</span> <span class="k">=</span> <span class="mi">2</span>
	
	
	<span class="k">def</span> <span class="nf">bar</span> <span class="k">=</span> <span class="mi">3</span>

<span class="o">}</span>

</code></pre></div></div>

<h3 id="object-definitions">Object Definitions</h3>

<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒEmptyç±»å…¶å®æ²¡æœ‰å˜åŒ–ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦é‡æ–°åˆ›å»ºï¼Œå¦‚æœæŠŠå®ƒå®šä¹‰ä¸ºä¸€ä¸ªå•ä¾‹ï¼Œåˆ™èƒ½çœå»è®¸å¤šé‡å¤åˆ›å»ºçš„instanceï¼Œåœ¨Scalaä¸­ï¼Œä½¿ç”¨<code class="highlighter-rouge">object</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">object</span> <span class="nc">class</span> <span class="nc">Empty</span> <span class="k">extends</span> <span class="nc">IntSet</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">contains</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span>
	
	<span class="k">def</span> <span class="nf">incl</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">IntSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NonEmpty</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="nc">Empty</span><span class="o">,</span><span class="nc">Empty</span><span class="o">)</span>
	
	<span class="k">override</span> <span class="k">def</span> <span class="nf">toString</span> <span class="k">=</span> <span class="o">{</span><span class="s">"."</span><span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>
    <p>This defines a <em>singleton object</em> named Empty.</p>
  </li>
  <li>
    <p>No other Empty instances can be created.</p>
  </li>
  <li>
    <p>Singleton objects are valeus , so Empty evaluates to itself</p>
  </li>
</ul>

<h3 id="programs">Programs</h3>

<p>ä¹‹å‰çš„ä»£ç éƒ½æ˜¯ä½¿ç”¨REPLæˆ–workSheetè¿è¡Œï¼Œè¿™ä¸€èŠ‚å°†ä¼šåˆ›å»ºä¸€ä¸ªScala Objectï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">package</span> <span class="nn">week4</span>

<span class="k">object</span> <span class="nc">week4</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span><span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">=</span> <span class="nf">println</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span>
 
<span class="o">}</span>

</code></pre></div></div>

<h3 id="dynamic-binding">Dynamic Binding</h3>

<p>Object-oriented languages(including Scala) implement <em>dynmaic method dispatch</em>.</p>

<p>This means that the code invoked by a method call depends on the runtime type of the object that contains the method.</p>

<ul>
  <li>Example</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Empty contains 1

-&gt; [1/x][Empty/this] false

= false

</code></pre></div></div>

<h3 id="something-to-ponder">Something to Ponder</h3>

<p>Dynamic dispatch of methods is analogous to calls to higher-order functions.</p>

<ul>
  <li>Question:</li>
</ul>

<p>Can we implement one concept in terms of the other?</p>

<ul>
  <li>
    <p>Objects in terms of higher-order functions?</p>
  </li>
  <li>
    <p>HOF in terms of objects?</p>
  </li>
</ul>

<h2 id="how-class-are-organized">How class are organized</h2>

<p>é»˜è®¤importçš„åŒ…ï¼š</p>

<ul>
  <li>
    <p>All members of package scala</p>
  </li>
  <li>
    <p>All members of package java.lang</p>
  </li>
  <li>
    <p>All members of the singleton object scala.Predef.</p>
  </li>
</ul>

<p>Here are the fully qualified names of some types and functions which you have seen so far:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Int 		=&gt; scala.Int
Boolean		=&gt; scala.Boolean
Obejct		=&gt; java.lang.Object
require 	=&gt; scala.predef.require
assert		=&gt; scala.predef.assert

</code></pre></div></div>

<h3 id="traits">Traits</h3>

<p>In Java, as well as in Scala, a class can only have one superclass.</p>

<p>But what if a class has several natural supertypes to which it conforms or from which it wants to inherit code?</p>

<p>Here, you could use traits.</p>

<p>A trait is declared like an abstract class, just with <code class="highlighter-rouge">trait</code> instead of <code class="highlighter-rouge">abstract</code> class.</p>

<p>Traitç±»ä¼¼Javaä¸­çš„interface</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">trait</span> <span class="nc">Planar</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">height</span><span class="k">:</span> <span class="kt">Int</span>
	<span class="k">def</span> <span class="nf">width</span> <span class="k">:</span> <span class="kt">Int</span>
	<span class="k">def</span> <span class="nf">surface</span> <span class="k">=</span> <span class="n">height</span><span class="o">*</span><span class="n">width</span>
<span class="o">}</span>

</code></pre></div></div>

<p>OBjectåªèƒ½ç»§æ‰¿ä¸€ä¸ªclassï¼Œä½†å¯ä»¥å®ç°å¤šä¸ªtrait</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Square</span> <span class="k">extends</span> <span class="nc">Shape</span> <span class="k">with</span> <span class="nc">Plannar</span> <span class="k">with</span> <span class="nc">Movable</span><span class="o">...</span>

</code></pre></div></div>
<p>Traits resemble interfaces in Java, but are more powerful because they can contains fields and concrete methods.</p>

<p>On the other hand, traits cannot have parameters, only classes can</p>

<p>Traitä¸­ä¸èƒ½å®šä¹‰property</p>

<p>###Top Types</p>

<p>Scalaæœ‰å‡ ä¸ªåŸºæœ¬ç±»å‹ï¼š</p>

<ul>
  <li>
    <p>Any : the base type of all types, Method: â€˜==â€™, â€˜!=â€™, â€˜equalsâ€™, â€˜hashCodeâ€™, â€˜toStringâ€™</p>
  </li>
  <li>
    <p>AnyRef : The base type of all reference types; Alias of â€˜java.lang.Objectâ€™</p>
  </li>
  <li>
    <p>AnyVal : The base type of all primitive types.</p>
  </li>
</ul>

<p>###The Nothing Type</p>

<p>Nothing is at the bottom of Scalaâ€™s type hierarchy. It is a subtype of every other type.</p>

<p>There is no value of type Nothing.</p>

<p>Why is that useful?</p>

<ul>
  <li>
    <p>To signal abnormal termination</p>
  </li>
  <li>
    <p>As an element type of empty collections</p>
  </li>
</ul>

<p>###Exceptions</p>

<p>Scalaâ€™s exception handling is similar to Javaâ€™s</p>

<p>The expression:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">error</span><span class="o">(</span><span class="n">msg</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="o">(</span><span class="n">msg</span><span class="o">)</span> 

</code></pre></div></div>

<p>###The Null Type</p>

<p>Every <strong>reference class type</strong> also has null as a value.</p>

<p>The type of <code class="highlighter-rouge">null</code> is <code class="highlighter-rouge">Null</code> .</p>

<p><code class="highlighter-rouge">Null</code> is a subtype of every class that inherits from <code class="highlighter-rouge">Object</code>; it is incompatible with subtypes of <code class="highlighter-rouge">AnyVal</code></p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">val</span> <span class="nv">x</span> <span class="k">=</span> <span class="kc">null</span> <span class="c1">//x:Null = null</span>

<span class="k">val</span> <span class="nv">y</span><span class="k">:</span><span class="kt">String</span> <span class="o">=</span> <span class="kc">null</span> <span class="c1">// y:String = null</span>

<span class="k">val</span> <span class="nv">z</span><span class="k">:</span><span class="kt">Int</span> <span class="o">=</span> <span class="kc">null</span> <span class="c1">//error: type mismatch</span>


</code></pre></div></div>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nf">if</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">false</span>                          <span class="c1">//&gt; res0: AnyVal = 1</span>

</code></pre></div></div>

<p>ifçš„ç¬¬ä¸€ä¸ªåˆ†æ”¯è¿”å›çš„ç±»å‹ä¸ºIntï¼Œç¬¬äºŒä¸ªåˆ†æ”¯è¿”å›çš„ç±»å‹ä¸ºbooleanï¼Œé‚£ä¹ˆè¡¨è¾¾å¼çš„ç±»å‹åº”è¯¥æ˜¯ä»–ä»¬å…±åŒçš„ç±»å‹ï¼šAnyVal</p>

<h2 id="polymorphism">Polymorphism</h2>

<p>ä»¥æ„å»ºä¸€ä¸ª<code class="highlighter-rouge">Con-Lists</code>ä¸ºä¾‹ï¼Œ<code class="highlighter-rouge">Con-List</code>æ˜¯ä¸€ä¸ªimmutable linked list</p>

<p>å®ƒå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ„å»º:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">Nil</code> : æ„å»ºä¸€ä¸ªemptyåˆ—è¡¨</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Cons</code> ä¸€ä¸ªåŒ…å«ä¸€ä¸ªelementçš„cellå’Œå…¶ä½™çš„listéƒ¨åˆ†</p>
  </li>
</ul>

<h3 id="cons-lists-in-scala">Cons-Lists in Scala</h3>

<p><code class="highlighter-rouge">Con-List</code>å¯ä»¥é€šè¿‡å¦‚ä¸‹æ•°æ®ç»“æ„æ ‡ç¤º:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">trait</span> <span class="nc">IntList</span>
<span class="o">{</span>
  
<span class="o">}</span>

<span class="k">class</span> <span class="nc">Cons</span><span class="o">(</span><span class="k">val</span> <span class="nv">head</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="k">val</span> <span class="nv">tail</span><span class="k">:</span><span class="kt">IntList</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">IntList</span>
<span class="o">{</span>
  

<span class="o">}</span>

<span class="k">class</span> <span class="nc">Nil</span> <span class="k">extends</span> <span class="nc">IntList</span>
<span class="o">{</span>
  
<span class="o">}</span>

</code></pre></div></div>

<p><code class="highlighter-rouge">Cons</code>çš„æ„é€ å‡½æ•°ä¸­å‚æ•°ç”¨<code class="highlighter-rouge">val</code>å£°æ˜äº†ï¼Œè¿™ç§æƒ…å†µç›¸å½“äºè‡ªåŠ¨ç»™æˆå‘˜å˜é‡èµ‹å€¼:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Cons</span><span class="o">(</span><span class="nc">_head</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="nc">_tail</span><span class="k">:</span><span class="kt">IntList</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">IntList</span>
<span class="o">{</span>
  	<span class="k">val</span> <span class="nv">heal</span> <span class="k">=</span> <span class="nc">_head</span><span class="o">;</span>
  	<span class="k">val</span> <span class="nv">tail</span> <span class="k">=</span> <span class="nc">_tail</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="type-parameters">Type Parameters</h3>

<p>ä»…ä»…å®šä¹‰intç±»å‹çš„listå¤ªå•ä¸€äº†ï¼Œå¸Œæœ›å°†å…¶æ‰©å±•åˆ°doubleï¼Œstringç±»å‹ï¼Œè¿™æ—¶å€™éœ€è¦ä½¿ç”¨æ³›å‹:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">trait</span> <span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="nc">class</span> <span class="nc">Cons</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="k">val</span> <span class="nv">head</span><span class="k">:</span><span class="kt">T</span><span class="o">,</span> <span class="k">val</span> <span class="nv">tail</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span> <span class="k">extends</span> <span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="k">class</span> <span class="nc">Nil</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="nc">extends</span> <span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> 

</code></pre></div></div>

<p>å®šä¹‰<code class="highlighter-rouge">trait</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">trait</span> <span class="nc">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">{</span>
  <span class="k">def</span> <span class="nf">isEmpty</span><span class="k">:</span><span class="kt">Boolean</span>
  
  <span class="k">def</span> <span class="nf">head</span><span class="k">:</span><span class="kt">T</span>
  
  <span class="k">def</span> <span class="nf">tail</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
  
<span class="o">}</span>

</code></pre></div></div>

<p>å®šä¹‰<code class="highlighter-rouge">Cons</code>,<code class="highlighter-rouge">Nil</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
class Cons[T](val head:T, val tail:List[T]) extends List[T]
{
  def isEmpty:Boolean = false

}

class Nil[T] extends List[T] 
{
	def isEmpty:Boolean = true
	
	def head:Nothing = throw new NoSuchElementException("Nil.head")
	
	def tail:Nothing = throw new NoSuchElementException("Nil.head")
}

</code></pre></div></div>

<p>###Generic Functions</p>

<p>å’Œç±»ä¸€æ ·ï¼Œå‡½æ•°ä¹Ÿæ”¯æŒæ³›å‹å‚æ•°[T], ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªå‡½æ•°åˆ›å»ºä¸€ä¸ªæ³›å‹List</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">singleton</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elem</span><span class="k">:</span><span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Cons</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">elem</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Nil</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span>

<span class="n">singleton</span><span class="o">[</span><span class="kt">Int</span><span class="o">](</span><span class="mi">1</span><span class="o">)</span>
<span class="n">singleton</span><span class="o">[</span><span class="kt">Boolean</span><span class="o">](</span><span class="kc">true</span><span class="o">)</span>

</code></pre></div></div>
<p>###Type Inference</p>

<p>äº‹å®ä¸Šï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹å‚æ•°ç±»å‹è¿›è¡Œæ¨æ–­,[T]å¯ä»¥çœç•¥ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>singleton(1)
singleton(true)

</code></pre></div></div>

<h3 id="types-and-evaluation">Types and Evaluation</h3>

<p>ç±»å‹å¹¶ä¸å½±å“Scalaè¿›è¡Œå‚æ•°æ›¿æ¢ï¼Œæ ¹æ®Substitutionè§„åˆ™ï¼Œå‚æ•°è¢«ä»£å…¥åï¼Œåœ¨æ‰§è¡Œè¡¨è¾¾å¼æ±‚å€¼å‰ï¼Œæ‰€æœ‰çš„ç±»å‹éƒ½è¢«removeæ‰ã€‚</p>

<p>è¿™ä¸€ç‰¹æ€§å«åš:<code class="highlighter-rouge">type erasure</code></p>

<p>ä½¿ç”¨è¿™ä¸€ç‰¹æ€§çš„è¯­è¨€æœ‰: Java,Scala,Haskell,ML,OCaml.</p>

<p>æœ‰äº›è¯­è¨€åœ¨runtimeä¸­ä»ç„¶å¸¦ç€ç±»å‹ï¼šC++,C#,F#</p>

<h3 id="polymorphism-1">Polymorphism</h3>

<p>è¿™æ¬¡æ¥è‡ªå¸Œè…Šï¼Œæ„æ€æ˜¯å¤šç§å½¢å¼ï¼ŒIn programming, å®ƒè¡¨ç¤º:</p>

<ul>
  <li>
    <p>å‡½æ•°çš„å‚æ•°å¯ä»¥æ˜¯å¤šç§ç±»å‹çš„</p>
  </li>
  <li>
    <p>æŸä¸€ç§ç±»å‹å¯ä»¥æœ‰å¾ˆå¤šå­ç±»å‹</p>
  </li>
</ul>

<p>æˆ‘ä»¬ç›®å‰å·²ç»çœ‹åˆ°è¿‡è¿™ä¸¤ä¸ªç‰¹æ€§:</p>

<ul>
  <li>
    <p>å­ç±»: å¯ä»¥å°†ä¸€ä¸ªçˆ¶ç±»å‹çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå­ç±»å‹</p>
  </li>
  <li>
    <p>æ³›å‹: å‡½æ•°å‚æ•°å’Œç±»çš„å‚æ•°å¯ä»¥å£°æ˜æˆæ³›å‹</p>
  </li>
</ul>

<p>###excise</p>

<p>å·²çŸ¥ä¸€ä¸ªlist: List[T]ï¼Œè¦æ±‚è¿”å›ç¬¬nä¸ªå…ƒç´ :</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">nth</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">n</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span><span class="kt">T</span> <span class="o">=</span> 
	
	<span class="nf">if</span> <span class="o">(</span><span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="o">)</span> <span class="nv">xs</span><span class="o">.</span><span class="py">head</span> 
	<span class="k">else</span> <span class="nf">nth</span><span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="nv">xs</span><span class="o">.</span><span class="py">tail</span><span class="o">)</span>

</code></pre></div></div>

<h2 id="2-11-functions-as-objects">2-11 Functions as Objects</h2>

<p>è¿™ä¸ªsectionè®²objectå’Œfunctionä¹‹é—´çš„å…³ç³»ï¼š</p>

<p>###Functions as Objects</p>

<p>åœ¨Scalaä¸­ï¼Œå‡½æ•°è¢«è®¤ä¸ºæ˜¯objectï¼š</p>

<p>ä¾‹å¦‚<code class="highlighter-rouge">A =&gt; B</code>è¿™ç§å‡½æ•°ç±»å‹å…¶å®æ˜¯<code class="highlighter-rouge">scala.Function1[A,B]</code>çš„ç¼©å†™ï¼Œå®šä¹‰ä¸ºï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">package</span> <span class="nn">scala</span>

<span class="k">trait</span> <span class="nc">Function1</span><span class="o">[</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">]{</span>

	<span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">A</span><span class="o">)</span><span class="k">:</span><span class="kt">B</span>

<span class="o">}</span>

</code></pre></div></div>

<p>æ‰€ä»¥ï¼Œå‡½æ•°åªæ˜¯objectçš„<code class="highlighter-rouge">apply</code>æ–¹æ³•ï¼ŒåŒæ ·çš„ï¼Œå¯¹äºå¤šä¸ªå‡½æ•°å…¥å‚çš„<code class="highlighter-rouge">trait</code>è¿˜æœ‰<code class="highlighter-rouge">Function2</code>,<code class="highlighter-rouge">Function3</code>,â€¦</p>

<h3 id="expansion-of-function-values">Expansion of Function Values</h3>

<p>åŒ¿åå‡½æ•°å¦‚ä¸‹ï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>

</code></pre></div></div>
<p>è¢«å±•å¼€å¦‚ä¸‹:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">{</span>
	<span class="k">class</span> <span class="nc">AnonFun</span> <span class="k">extends</span> <span class="nc">Function1</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Int</span><span class="o">]</span>
	<span class="o">{</span>
		<span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">Int</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
	<span class="o">}</span>
	
	<span class="k">new</span> <span class="nc">AnonFun</span>
<span class="o">}</span>

</code></pre></div></div>

<p>æˆ–è€…æ›´ç®€å•çš„ï¼Œä½¿ç”¨åŒ¿åç±»ï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">new</span> <span class="nc">Function1</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Int</span><span class="o">]</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="expansion-of-function-calls">Expansion of Function Calls</h3>

<p>è¿™æ ·çš„å‡½æ•°è°ƒç”¨<code class="highlighter-rouge">f(a,b)</code>ä¼šæ‰©å±•ä¸ºï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nv">f</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">)</span>

</code></pre></div></div>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">val</span> <span class="nv">f</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>

<span class="nf">f</span><span class="o">(</span><span class="mi">7</span><span class="o">)</span>

</code></pre></div></div>

<p>è¢«æ‰©å±•ä¸º:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">val</span> <span class="nv">f</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Function1</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Int</span><span class="o">]{</span> <span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">}</span>
<span class="nv">f</span><span class="o">.</span><span class="py">apply</span><span class="o">(</span><span class="mi">7</span><span class="o">)</span>

</code></pre></div></div>

<p>æ‰€ä»¥ï¼š<strong>Functions are just Objects</strong></p>

<h3 id="functions-and-methods">Functions and Methods</h3>

<p>ä¸‹é¢çš„æ–¹æ³•ï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">f</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">:</span><span class="kt">Boolean</span> <span class="o">=</span> <span class="o">...</span>

</code></pre></div></div>

<p>ç”±ä¸Šä¸€å°èŠ‚å¯çŸ¥<code class="highlighter-rouge">f</code>æœ¬èº«å¹¶ä¸æ˜¯å‡½æ•°ç±»å‹ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯¹è±¡çš„<code class="highlighter-rouge">apply</code>æ–¹æ³•ã€‚</p>

<p>ä½†æ˜¯å¦‚æœ<code class="highlighter-rouge">f</code>è¢«æ”¾åˆ°äº†ç­‰å·å³è¾¹ï¼Œéœ€è¦æˆä¸ºä¸€ä¸ªå‡½æ•°ç±»å‹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è½¬æ¢:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nf">f</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>

</code></pre></div></div>

<p>ä¸Šé¢çš„åŒ¿åå‡½æ•°å†å±•å¼€ï¼š</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">new</span> <span class="nc">Function1</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Boolean</span><span class="o">]</span>
<span class="o">{</span>
	<span class="k">def</span> <span class="nf">apply</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nf">f</span><span class="o">(</span><span class="n">x</span><span class="o">)</span>
<span class="o">}</span>

</code></pre></div></div>
<h2 id="objects-everywhere">Objects Everywhere</h2>

<p>åˆ°ç›®å‰ï¼Œæˆ‘ä»¬</p>

<h3 id="scala-doc">Scala Doc</h3>

<p>www.scala-lang.org/api/current</p>
:ET