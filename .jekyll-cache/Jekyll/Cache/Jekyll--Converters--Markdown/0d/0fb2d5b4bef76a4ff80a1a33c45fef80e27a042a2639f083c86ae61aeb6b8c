I"¶»<blockquote>
  <p>æ–‡ä¸­æ‰€ç”¨åˆ°çš„å›¾ç‰‡éƒ¨åˆ†æˆªå–è‡ªAndrew Ngåœ¨<a href="https://www.coursera.org/learn/machine-learning">Couseraä¸Šçš„è¯¾ç¨‹</a></p>
</blockquote>

<h3 id="é€»è¾‘å›å½’">é€»è¾‘å›å½’</h3>

<p>ä¸Šä¸€èŠ‚çš„çº¿æ€§å›å½’å¯ä»¥çœ‹åˆ°ï¼Œå›å½’é—®é¢˜åœ¨æ•°å­¦ä¸Šæ¥è¯´æ˜¯å»ºç«‹$y$ä¸$x$ä¹‹é—´å…³ç³»çš„æ¨¡å‹ï¼Œç»™å®šä¸€ä¸ªç‚¹é›†ï¼Œèƒ½å¤Ÿç”¨ä¸€æ¡æ›²çº¿å»æ‹Ÿåˆä¹‹ï¼Œå¦‚æœè¿™ä¸ªæ›²çº¿æ˜¯ä¸€æ¡ç›´çº¿ï¼Œé‚£å°±è¢«ç§°ä¸ºçº¿æ€§å›å½’ï¼Œå¦‚æœæ›²çº¿æ˜¯ä¸€æ¡äºŒæ¬¡æ›²çº¿ï¼Œå°±è¢«ç§°ä¸ºäºŒæ¬¡å›å½’ï¼Œå›å½’è¿˜æœ‰å¾ˆå¤šçš„å˜ç§ï¼Œç­‰ç­‰ã€‚å¦‚æœå¾—åˆ°çš„é¢„æµ‹å‡½æ•°å¾—å‡ºçš„ç»“æœæ˜¯ç¦»æ•£çš„ï¼Œæˆ‘ä»¬æŠŠè¿™ç§å­¦ä¹ é—®é¢˜å«åš<strong>åˆ†ç±»é—®é¢˜</strong>ã€‚é€»è¾‘å›å½’ç»å¸¸ç”¨äºè§£å†³åˆ†ç±»é—®é¢˜, æ¯”å¦‚Emailæ˜¯å¦ä¸ºSpam/éSpam, è‚¿ç˜¤æ˜¯å¦ä¸ºæ¶æ€§/è‰¯æ€§ï¼Œå¯ç”¨ä¸‹é¢å¼å­è¡¨è¾¾</p>

<script type="math/tex; mode=display">y âˆˆ {0,1}</script>

<p>å¯¹äºåˆ†ç±»åœºæ™¯ï¼Œä½¿ç”¨çº¿æ€§å›å½’æ¨¡å‹ä¸é€‚åˆï¼ŒåŸå› æ˜¯ $h_{\theta}(x)$ å€¼ä¸èƒ½ä¿è¯åªæœ‰<code class="highlighter-rouge">0</code>æˆ–<code class="highlighter-rouge">1</code>ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹çº¿æ€§æ¨¡å‹åšä¸€äº›æ”¹è¿›ã€‚</p>

<h3 id="sigmoidå‡½æ•°">Sigmoidå‡½æ•°</h3>

<p>åœ¨ç»™å‡ºæ¨¡å‹å‰ï¼Œæˆ‘ä»¬å…ˆå‡è®¾$y$çš„å–å€¼æ˜¯è¿ç»­çš„ï¼Œåˆ™å¯¹äºä»»æ„çš„è¾“å…¥æœ‰</p>

<script type="math/tex; mode=display">0â‰¤h_{\theta}(x)â‰¤1</script>

<p>ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªéçº¿æ€§å‡½æ•°$g(x)$å°†$h_{\theta}(x)$çš„è¾“å‡ºæ˜ å°„åˆ°<code class="highlighter-rouge">0</code>å’Œ<code class="highlighter-rouge">1</code>ä¹‹é—´ï¼Œå³$h_{\theta}(x)=\theta^{T}x$ åšå¦‚ä¸‹å˜æ¢ï¼š$h_{\theta}(x)=g(\theta^{T}x)$, å…¶ä¸­$g$ä¸º</p>

<script type="math/tex; mode=display">g(z)=\frac{1}{1+e^{-z}}</script>

<p>å¯ä»¥å¾—åˆ°$g(x)$çš„å‡½æ•°æ›²çº¿å¦‚ä¸‹</p>

<p><img src="/assets/images/2017/09/ml-5-1.png" alt="" /></p>

<p>æˆ‘ä»¬çœ‹åˆ°å‡½æ•°$g(x)$ å°†æ‰€æœ‰å®æ•°æ˜ å°„åˆ°äº†<code class="highlighter-rouge">(0,1]</code>ç©ºé—´å†…, åˆ™$g(z)$ ä¹Ÿå«åš<strong>Sigmoid Function</strong>ã€‚</p>

<h3 id="linear-decision-boundary">Linear Decision Boundary</h3>

<p>é€šè¿‡è§‚å¯Ÿå‡½æ•°æ›²çº¿å¯ä»¥å‘ç°ï¼Œå½“<code class="highlighter-rouge">z</code>å¤§äº 0 çš„æ—¶å€™<code class="highlighter-rouge">g(z)â‰¥0.5</code>ï¼Œå› æ­¤åªéœ€è¦åˆ¤æ–­$\theta^{(T)}x$å’Œ<code class="highlighter-rouge">0</code>çš„å…³ç³»å³å¯ï¼š</p>

<ul>
  <li>$\theta^{(T)}x â‰¥ 0$ å¯æ¨å‡º $y=1$</li>
  <li>$\theta^{(T)}x &lt; 0$ å¯æ¨å‡º $y=0$</li>
</ul>

<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰ä¸€ä¸ªäºŒç»´çº¿æ€§é¢„æµ‹å‡½æ•°ä¸º</p>

<script type="math/tex; mode=display">h_{\theta}(x) = g(\theta_0 + \theta_1x_1 + \theta_2x_2)</script>

<p>ç°åœ¨å‡è®¾Î¸å€¼å·²ç¡®å®šä¸º<code class="highlighter-rouge">[-3,1,1]</code>ï¼Œåˆ™é—®é¢˜å˜ä¸ºæ±‚å¦‚æœè¦<code class="highlighter-rouge">y=1</code>ï¼Œé‚£ä¹ˆéœ€è¦ $h(x) = -3 + x_1+x_2 â‰¥ 0$, å³æ‰¾åˆ°$x_1$, $x_2$æ»¡è¶³ $x_1 + x_2 â‰¥ 3$ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>

<p><img src="/assets/images/2017/09/ml-lr-1.png" alt="" /></p>

<p>ç”±ä¸Šå›¾å¯çœ‹å‡º, å›¾ä¸­çš„ç²‰è‰²çº¿æ®µä¸ºå¯ä»¥ä½œä¸º<strong>Decision Boundary</strong>ã€‚å½“$x_1 + x_2 â‰¥ 3$æ—¶é¢„æµ‹ç»“æœ$y=1$ï¼Œåä¹‹ï¼Œå½“$x_1 + x_2 &lt; 3$æ—¶ï¼Œé¢„æµ‹ç»“æœ$y=0$</p>

<h3 id="non-linear-decision-boundary">Non-linear Decision Boundary</h3>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸ªéçº¿æ€§çš„é¢„æµ‹å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p>

<script type="math/tex; mode=display">h_{\theta}x = g(\theta_0 + \theta_1x_1 + \theta_2x_2 + \theta_3x_1{^2} + \theta_4x_2{^2})</script>

<p>å‡è®¾<code class="highlighter-rouge">Î¸</code>å€¼å·²ç»ç¡®å®šä¸º<code class="highlighter-rouge">[-1,0,0,1,1]</code>ï¼ŒåŒä¸Šï¼Œå˜ä¸ºæ±‚å¦‚æœè¦<code class="highlighter-rouge">y=1</code>ï¼Œé‚£ä¹ˆéœ€è¦$-1 + x_1{^2} + x_2{^2} â‰¥ 0$ï¼Œå³æ‰¾åˆ°$x_1$, $x_2$æ»¡è¶³$x_1^2 + x_2^2 â‰¥ 0$ï¼Œåˆ™è¾¹ç•Œå‡½æ•°ä¸º$x_1^2 + x_2^2 = 0$ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-lr-2.png" alt="" /></p>

<p>å¤„äºç²‰è‰²åœ†åœˆå†…çš„æ ·æœ¬ç‚¹é¢„æµ‹ç»“æœä¸º0, å¯¹äºè½åœ¨åœˆå¤–çš„æ ·æœ¬ç‚¹ï¼Œåˆ™é¢„æµ‹ç»“æœä¸º1ã€‚å› æ­¤è¿™ç§è¾¹ç•Œç§°ä¸ºéçº¿æ€§çš„<strong>Decision Boundary</strong></p>

<h3 id="cost-function">Cost Function</h3>

<p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰€è°“çš„é€»è¾‘å›å½’ï¼Œå°±æ˜¯é€šè¿‡sigmoidå‡½æ•°å°†æŸä¸ªé¢„æµ‹å‡½æ•°ï¼ˆå¯èƒ½æ˜¯éçº¿æ€§å‡½æ•°ï¼‰çš„å€¼åŸŸé™å®šåœ¨æŸä¸ªåŒºåŸŸå†…ï¼Œä»è€Œè¾¾åˆ°å¯¹è¾“å‡ºè¿›è¡Œåˆ†ç±»çš„æ•ˆæœã€‚ å› æ­¤å½“æˆ‘ä»¬æœ‰äº†æ¨¡å‹ä»¥åï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜ä¾¿æ˜¯æ‰¾åˆ°ä¸€ä¸ªä»£ä»·å‡½æ•°æ¥æ±‚è§£<code class="highlighter-rouge">Î¸</code>å€¼ï¼Œå¦‚æœä½¿ç”¨ä¹‹å‰ç°è¡Œå›å½’çš„ cost functionï¼Œå³</p>

<script type="math/tex; mode=display">J(\theta) =\frac{1}{2m}\sum_{i=1}^m(h_\theta(x_i)-y_i)^2</script>

<p>ç”±äº$h(x)$å˜æˆäº†å¤æ‚çš„éçº¿æ€§å‡½æ•°ï¼Œè¿™æ—¶ä¼šå‡ºç°$J(\theta)$å­˜æ‰å¤šä¸ªlocal minimumçš„æƒ…å†µï¼Œå³$J(\theta)$ä¸æ˜¯ä¸€ä¸ªconvex functionï¼Œå› æ­¤æ¢¯åº¦ä¸‹é™æ— æ³•å¾—åˆ°æœ€å°å€¼ã€‚å› æ­¤æˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ä¸ªæ–°çš„ä»£ä»·å‡½æ•°</p>

<script type="math/tex; mode=display">% <![CDATA[
Cost(h_\theta(x),y) =\begin{cases}-log(h_\theta(x)),  & \text{if  $y=1$} \\-log(1-h_\theta(x)),  & \text{if $y=0$}\end{cases} %]]></script>

<p>å½“<code class="highlighter-rouge">y=1</code>çš„æ—¶å€™ï¼Œ<code class="highlighter-rouge">J(Î¸) = 0</code> -&gt; <code class="highlighter-rouge">h(x)=1</code>ï¼›<code class="highlighter-rouge">J(Î¸) = âˆ</code> -&gt; <code class="highlighter-rouge">h(x)=0</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-5-2.png" alt="" /></p>

<p>å½“<code class="highlighter-rouge">y=0</code>çš„æ—¶å€™ï¼Œ<code class="highlighter-rouge">J(Î¸) =0</code> -&gt; <code class="highlighter-rouge">h(x)=0</code>ï¼Œ<code class="highlighter-rouge">J(Î¸) = âˆ</code> -&gt; <code class="highlighter-rouge">h(x)=1</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-5-3.png" alt="" /></p>

<p>å›¾ä¸Šå¯ä»¥çœ‹å‡º<code class="highlighter-rouge">J(Î¸)</code>æœ‰æå€¼ç‚¹ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯åˆ†åˆ«æ±‚è§£<code class="highlighter-rouge">h(x)=0</code>å’Œ<code class="highlighter-rouge">h(x)=1</code>ä¸¤ç§æƒ…å†µä¸‹çš„<code class="highlighter-rouge">Î¸</code>å€¼</p>

<h3 id="simplifed-cost-function">Simplifed Cost Function</h3>

<p>ä¸Šè¿° Cost Function å¯ä»¥ç®€åŒ–ä¸ºä¸€è¡Œï¼š</p>

<script type="math/tex; mode=display">Cost(h_\theta(x),y) = -y\log(h_\theta(x)) - (1-y)\log(1-h_\theta(x))</script>

<p>ä¹‹æ‰€ä»¥å°†ä¸Šè¿°å¼å­ç®€åŒ–ä¸ºä¸€è¡Œï¼Œå…¶ç›®çš„æ˜¯æ–¹ä¾¿ä½¿ç”¨æ¦‚ç‡è®ºä¸­çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ±‚è§£ï¼Œæ¥ä¸‹æ¥è¿˜æ˜¯é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£$\theta$ï¼Œæ˜¯costå‡½æ•°æœ€å°ã€‚æˆ‘ä»¬å¦$J(\theta)$ç­‰äº</p>

<script type="math/tex; mode=display">J(\theta) = -\frac{1}{m}\sum_{i=1}^{m}[(y^{(i)}\log{(h_{(\theta)}(x^{(i)}))} + (1-y^{(i)})\log{(1-h_{(\theta)}(x^{(i)}))} ]</script>

<p>å‘é‡åŒ–çš„å®ç°ä¸ºï¼š</p>

<script type="math/tex; mode=display">J(\theta) = \frac{1}{m}\cdot (-y^{(T)}log(h) - (1-y)^{(T)}log(1-h))</script>

<h3 id="gradient-descent">Gradient Descent</h3>

<p>å‰é¢å¯çŸ¥æ¢¯åº¦ä¸‹é™å…¬å¼ä¸º:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <mi>R</mi>
        <mi>e</mi>
        <mi>p</mi>
        <mi>e</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mspace width="thickmathspace" />
        <mo fence="false" stretchy="false">{</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mspace width="thickmathspace" />
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
        </msub>
        <mo>:=</mo>
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
        </msub>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>&#x03B1;<!-- Î± --></mi>
        <mstyle>
          <mfrac>
            <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
              <msub>
                <mi>&#x03B8;<!-- Î¸ --></mi>
                <mi>j</mi>
              </msub>
            </mrow>
          </mfrac>
        </mstyle>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mo fence="false" stretchy="false">}</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>å¯¹<math><msub><mi>J</mi><mo>(Î¸)</mo></msub></math>æ±‚åå¯¼ï¼Œå¾—åˆ°æ¢¯åº¦ä¸‹é™å…¬å¼ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <mi>R</mi>
        <mi>e</mi>
        <mi>p</mi>
        <mi>e</mi>
        <mi>a</mi>
        <mi>t</mi>
        <mspace width="thickmathspace" />
        <mo fence="false" stretchy="false">{</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mspace width="thickmathspace" />
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
        </msub>
        <mo>:=</mo>
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
        </msub>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mfrac>
          <mi>&#x03B1;<!-- Î± --></mi>
          <mi>m</mi>
        </mfrac>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>m</mi>
        </munderover>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <msup>
          <mi>y</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <msubsup>
          <mi>x</mi>
          <mi>j</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mo fence="false" stretchy="false">}</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>æ³¨æ„åˆ°ä¸Šè¿°å…¬å¼å’Œçº¿æ€§å›å½’ä½¿ç”¨çš„æ¢¯åº¦ä¸‹é™å…¬å¼ç›¸åŒï¼Œä¸åŒçš„æ˜¯<code class="highlighter-rouge">h(Î¸)</code>ï¼Œä¸Šè¿°å…¬å¼å‘é‡åŒ–è¡¨ç¤ºä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>&#x03B8;<!-- Î¸ --></mi>
  <mo>:=</mo>
  <mi>&#x03B8;<!-- Î¸ --></mi>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <mfrac>
    <mi>&#x03B1;<!-- Î± --></mi>
    <mi>m</mi>
  </mfrac>
  <msup>
    <mi>X</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>T</mi>
    </mrow>
  </msup>
  <mo stretchy="false">(</mo>
  <mi>g</mi>
  <mo stretchy="false">(</mo>
  <mi>X</mi>
  <mi>&#x03B8;<!-- Î¸ --></mi>
  <mo stretchy="false">)</mo>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <mrow class="MJX-TeXAtom-ORD">
    <mover>
      <mi>y</mi>
      <mo stretchy="false">&#x2192;<!-- â†’ --></mo>
    </mover>
  </mrow>
  <mo stretchy="false">)</mo>
</math>

<h3 id="advanced-optimization">Advanced Optimization</h3>

<p>å¯¹äºæ±‚è§£<math><msub><mi>J</mi><mo>(Î¸)</mo></msub></math>çš„æœ€å°å€¼ï¼Œç›®å‰çš„åšæ³•æ˜¯ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œå¯¹<code class="highlighter-rouge">Î¸</code>æ±‚åå¯¼ï¼Œé™¤äº†æ¢¯åº¦ä¸‹é™ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶å®ƒå‡ ç§ä¼˜åŒ–ç®—æ³•ï¼š</p>

<ul>
  <li>Conjugate gradient</li>
  <li>BFGS</li>
  <li>L-BFGS</li>
</ul>

<p>è¿™ä¸‰ç§ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ï¼š</p>

<ul>
  <li>ä¸éœ€è¦äººå·¥é€‰æ‹©<code class="highlighter-rouge">Î±</code></li>
  <li>æ¯”ä½åº¦ä¸‹é™æ›´å¿«</li>
</ul>

<p>ç¼ºç‚¹æ˜¯ï¼šæ¯”è¾ƒå¤æ‚</p>

<p>å¼€å‘è€…ä¸éœ€è¦è‡ªå·±å®ç°è¿™äº›ç®—æ³•ï¼Œåœ¨ä¸€èˆ¬çš„æ•°å€¼è®¡ç®—åº“é‡Œéƒ½æœ‰ç›¸åº”çš„å®ç°ï¼Œä¾‹å¦‚ pythonï¼ŒOctave ç­‰ã€‚æˆ‘ä»¬åªéœ€è¦å…³å¿ƒä¸¤ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ç»™å‡º:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mstyle>
          <mfrac>
            <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
            <mrow>
              <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
              <msub>
                <mi>&#x03B8;<!-- Î¸ --></mi>
                <mi>j</mi>
              </msub>
            </mrow>
          </mfrac>
        </mstyle>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Octave å†™è¿™æ ·ä¸€ä¸ªå‡½æ•°:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function [jVal, gradient] = costFunction(theta)
  jVal = [...code to compute J(theta)...];
  gradient = [...code to compute derivative of J(theta)...];
end
</code></pre></div></div>

<p>ç„¶åä½¿ç”¨ Octave è‡ªå¸¦çš„<code class="highlighter-rouge">fminunc()</code>ä¼˜åŒ–ç®—æ³•è®¡ç®—å‡º<code class="highlighter-rouge">Î¸</code>çš„å€¼ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>options = optimset('GradObj', 'on', 'MaxIter', 100);
initialTheta = zeros(2,1);
   [optTheta, functionVal, exitFlag] = fminunc(@costFunction, initialTheta, options);
</code></pre></div></div>

<p><code class="highlighter-rouge">fminunc()</code>å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šcostFunctionï¼Œåˆå§‹çš„ Î¸ å€¼ï¼ˆè‡³å°‘æ˜¯ 2x1 çš„å‘é‡ï¼‰ï¼Œè¿˜æœ‰ options</p>

<h3 id="multiclass-classification">Multiclass classification</h3>

<p>å‰é¢æˆ‘ä»¬è§£å†³çš„é—®é¢˜éƒ½æ˜¯é’ˆå¯¹ä¸¤ä¸ªåœºæ™¯è¿›è¡Œåˆ†ç±»ï¼Œå³ y = {0,1} å®é™…ç”Ÿæ´»ä¸­ï¼Œå¸¸å¸¸æœ‰å¤šä¸ªåœºæ™¯éœ€è¦å½’ç±»ï¼Œä¾‹å¦‚</p>

<ul>
  <li>Email foldering/taggingï¼šWorkï¼ŒFriendsï¼ŒFamilyï¼ŒHobby</li>
  <li>Weatherï¼šSunnyï¼ŒCloudyï¼ŒRainï¼ŒSnow</li>
</ul>

<p>å³åˆ†ç±»ç»“æœä¸åªæ˜¯ 0 æˆ– 1ï¼Œè€Œæ˜¯å¤šä¸ª y = {0,1â€¦n}ï¼Œè§£å†³å¤šä¸ªåˆ†ç±»æˆ‘ä»¬ä½¿ç”¨ one-vs-all çš„æ–¹å¼ï¼Œå³é€‰å–æŸä¸€ä¸ªåœºæ™¯è¿›è¡Œå½’ç±»æ—¶ï¼Œå°†å…¶ä»–åœºæ™¯åˆå¹¶ä¸ºèµ·å¯¹ç«‹çš„åœºæ™¯ã€‚å¦‚å›¾ï¼š</p>

<p><img src="/assets/images/2017/09/ml-5-4.png" alt="" /></p>

<p>ä¸Šå›¾å¯çŸ¥æˆ‘ä»¬å…ˆå–ä¸€ä¸ª class è¿›è¡Œè®¡ç®—ï¼Œå°†å…¶ä»–çš„å½’ç±»ä¸ºå¦ä¸€ä¸ª classï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å‰é¢æåˆ°çš„ binary regression model è¿›è¡Œè®¡ç®—ï¼Œå³</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <mi>y</mi>
        <mo>&#x2208;<!-- âˆˆ --></mo>
        <mo fence="false" stretchy="false">{</mo>
        <mn>0</mn>
        <mo>,</mo>
        <mn>1</mn>
        <mo>.</mo>
        <mo>.</mo>
        <mo>.</mo>
        <mi>n</mi>
        <mo fence="false" stretchy="false">}</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <msubsup>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>0</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo>=</mo>
        <mn>0</mn>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>x</mi>
        <mo>;</mo>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <msubsup>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo>=</mo>
        <mn>1</mn>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>x</mi>
        <mo>;</mo>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mo>&#x22EF;<!-- â‹¯ --></mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <msubsup>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>n</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mi>y</mi>
        <mo>=</mo>
        <mi>n</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mi>x</mi>
        <mo>;</mo>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="normal">p</mi>
          <mi mathvariant="normal">r</mi>
          <mi mathvariant="normal">e</mi>
          <mi mathvariant="normal">d</mi>
          <mi mathvariant="normal">i</mi>
          <mi mathvariant="normal">c</mi>
          <mi mathvariant="normal">t</mi>
          <mi mathvariant="normal">i</mi>
          <mi mathvariant="normal">o</mi>
          <mi mathvariant="normal">n</mi>
        </mrow>
        <mo>=</mo>
        <munder>
          <mo movablelimits="true">max</mo>
          <mi>i</mi>
        </munder>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<ul>
  <li>One-vs-all(one-vs-rest):</li>
</ul>

<p>Train a logistic regression classifier<math><msubsup><mi>h</mi><mi>Î¸</mi><mi>(i)</mi></msubsup><mi>(x)</mi></math> for each class <math><mi>i</mi></math> to predict the probability that <math><mi>y</mi><mo>=</mo><mi>i</mi></math>.</p>

<p>On a new input <math><mi>x</mi></math>, to make a prediction, pick the class <math><mi>i</mi></math> that maximizes</p>

<ul>
  <li>æ€»ç»“ä¸€ä¸‹å°±æ˜¯å¯¹æ¯ç§åˆ†ç±»å…ˆè®¡ç®—ä»–çš„<math><msub><mi>h</mi><mi>Î¸</mi></msub><mi>(x)</mi></math>ï¼Œå½“æœ‰ä¸€ä¸ªæ–°çš„<code class="highlighter-rouge">x</code>éœ€è¦åˆ†ç±»æ—¶ï¼Œé€‰ä¸€ä¸ªè®©<math><msub><mi>h</mi><mi>Î¸</mi></msub><mi>(x)</mi></math>å€¼æœ€å¤§çš„åˆ†ç±»å™¨ã€‚</li>
</ul>

<h3 id="é™„å½•regularization">é™„å½•ï¼šRegularization</h3>

<h3 id="the-problem-of-overfitting">The problem of overfitting</h3>

<p>ä»¥çº¿æ€§å›å½’çš„é¢„æµ‹æˆ¿ä»·ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>

<p><img src="/assets/images/2017/09/ml-5-5.png" alt="" /></p>

<p>å¯ä»¥çœ‹åˆ°:</p>

<ul>
  <li>é€šè¿‡çº¿æ€§å‡½æ•°é¢„æµ‹æˆ¿ä»·ä¸å¤Ÿç²¾ç¡®(underfit)ï¼Œæœ¯è¯­å«åšâ€High Biasâ€ï¼Œå…¶åŸå› ä¸»è¦æ˜¯æ ·æœ¬çš„ feature å¤ªå°‘äº†ã€‚</li>
  <li>é€šè¿‡äºŒæ¬¡å‡½æ•°æ‹Ÿåˆå‡ºæ¥çš„æ›²çº¿åˆšå¥½å¯ä»¥è´¯ç©¿å¤§éƒ¨åˆ†æ•°æ®æ ·æœ¬ï¼Œæœ¯è¯­å«åšâ€Just Rightâ€</li>
  <li>
    <p>é€šè¿‡å››é˜¶å¤šé¡¹å¼æ‹Ÿåˆå‡ºæ¥çš„æ›²çº¿è™½ç„¶èƒ½è´¯ç©¿æ‰€æœ‰æ•°æ®æ ·æœ¬ï¼Œä½†æ˜¯æ›²çº¿æœ¬èº«ä¸å¤Ÿè§„åˆ™ï¼Œå½“æœ‰æ–°æ ·æœ¬å‡ºç°æ—¶ä¸èƒ½å¾ˆå¥½çš„é¢„æµ‹ã€‚è¿™ç§æƒ…å†µæˆ‘ä»¬å«åš<strong>Over Fittingï¼ˆè¿‡åº¦æ‹Ÿåˆï¼‰</strong>ï¼Œæœ¯è¯­å«åšâ€High varianceâ€ã€‚If we have too many features, the learned hypothesis may fit the training set very wellï¼ˆ<code class="highlighter-rouge">J(Î¸)=0</code>ï¼‰, but fail to generalize to new examples(predict prices on new examples) Over Fitting çš„é—®é¢˜åœ¨æ ·æœ¬å°‘ï¼Œfeature å¤šçš„æ—¶å€™å¾ˆæ˜æ˜¾</p>
  </li>
  <li>Addressing overfitting: - Reduce number of features - Manually select which features to keep. - Model selection algorithm - Regularization - Keep all features, but reduce magnitude/values of parameters <math><msub><mi>Î¸</mi><mi>j</mi></msub></math> - Works well when we have a lot of features, each of which contributes a bit to predicting<math><mi>y</mi></math></li>
</ul>

<h3 id="regularization-cost-function">Regularization Cost Function</h3>

<p>å¦‚æœè¦å‡å°‘ overfitting çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é™ä½ä¸€äº›å‚æ•°çš„æƒé‡ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦è®©ä¸‹é¢çš„å‡½æ•°å˜æˆäºŒæ¬¡æ–¹ç¨‹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>0</mn>
  </msub>
  <mo>+</mo>
  <msub>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>1</mn>
  </msub>
  <mi>x</mi>
  <mo>+</mo>
  <msub>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>2</mn>
  </msub>
  <msup>
    <mi>x</mi>
    <mn>2</mn>
  </msup>
  <mo>+</mo>
  <msub>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>3</mn>
  </msub>
  <msup>
    <mi>x</mi>
    <mn>3</mn>
  </msup>
  <mo>+</mo>
  <msub>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>4</mn>
  </msub>
  <msup>
    <mi>x</mi>
    <mn>4</mn>
  </msup>
</math>

<p>æˆ‘ä»¬æƒ³è¦åœ¨ä¸å»æ‰ Î¸3 å’Œ Î¸4 çš„å‰æä¸‹ï¼Œé™ä½<math><msub><mi>Î¸</mi><mn>3</mn></msub><msup><mi>x</mi><mn>3</mn></msup></math>å’Œ<math><msub><mi>Î¸</mi><mn>4</mn></msub><msup><mi>x</mi><mn>4</mn></msup></math>çš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ cost function ä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>m</mi>
  <mi>i</mi>
  <msub>
    <mi>n</mi>
    <mi>&#x03B8;<!-- Î¸ --></mi>
  </msub>
  <mtext>&#xA0;</mtext>
  <mstyle displaystyle="true">
    <mfrac>
      <mn>1</mn>
      <mrow>
        <mn>2</mn>
        <mi>m</mi>
      </mrow>
    </mfrac>
  </mstyle>
  <munderover>
    <mo>&#x2211;<!-- âˆ‘ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>m</mi>
  </munderover>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>h</mi>
    <mi>&#x03B8;<!-- Î¸ --></mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <msup>
    <mi>y</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <msup>
    <mo stretchy="false">)</mo>
    <mn>2</mn>
  </msup>
  <mo>+</mo>
  <mn>1000</mn>
  <mo>&#x22C5;<!-- â‹… --></mo>
  <msubsup>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>3</mn>
    <mn>2</mn>
  </msubsup>
  <mo>+</mo>
  <mn>1000</mn>
  <mo>&#x22C5;<!-- â‹… --></mo>
  <msubsup>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mn>4</mn>
    <mn>2</mn>
  </msubsup>
</math>

<p>æˆ‘ä»¬åœ¨åŸæ¥çš„ cost function åé¢å¢åŠ äº†ä¸¤é¡¹ï¼Œä¸ºäº†è®© cost function æ¥è¿‘ 0ï¼Œæˆ‘ä»¬éœ€è¦è®©<math><msub><mi>Î¸</mi><mn>3</mn></msub></math>,<math><msub><mi>Î¸</mi><mn>4</mn></msub></math>è¿‘ä¼¼ä¸º 0ï¼Œè¿™æ ·å³ä¼šæå¤§çš„å‡å°‘<math><msub><mi>Î¸</mi><mn>3</mn></msub><msup><mi>x</mi><mn>3</mn></msup></math>å’Œ<math><msub><mi>Î¸</mi><mn>4</mn></msub><msup><mi>x</mi><mn>4</mn></msup></math>çš„å€¼ï¼Œå‡å°‘åçš„æ›²çº¿å¦‚ä¸‹å›¾ç²‰è‰²æ›²çº¿ï¼Œæ›´æ¥è¿‘äºŒæ¬¡å‡½æ•°ï¼š</p>

<p><img src="/assets/images/2017/09/ml-5-6.png" alt="" /></p>

<p>Small values for parameters <math><msub><mi>Î¸</mi><mn>0</mn></msub><mo>,</mo><msub><mi>Î¸</mi><mn>1</mn></msub><mo>,...,</mo><msub><mi>Î¸</mi><mn>n</mn></msub></math></p>

<ul>
  <li>â€œSimplerâ€ hypothesisï¼Œé€‰å–æ›´å°çš„<code class="highlighter-rouge">Î¸</code>å€¼èƒ½å¾—åˆ°æ›´ç®€å•çš„é¢„æµ‹å‡½æ•°ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚æœå°† <math><msub><mi>Î¸</mi><mn>3</mn></msub><mo>,</mo><msub><mi>Î¸</mi><mn>4</mn></msub></math>è¿‘ä¼¼ä¸º 0 çš„è¯ï¼Œé‚£ä¹ˆä¸Šè¿°å‡½æ•°å°†å˜ä¸ºäºŒæ¬¡æ–¹ç¨‹ï¼Œæ›´è´´è¿‘åˆç†çš„å‡è®¾å‡½æ•°</li>
  <li>Housing example: - Feature: <math><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,...,</mo><msub><mi>Î¸</mi><mn>100</mn></msub></math> - Parameters: <math><msub><mi>Î¸</mi><mn>0</mn></msub><mo>,</mo><msub><mi>Î¸</mi><mn>1</mn></msub><mo>,...,</mo><msub><mi>Î¸</mi><mn>100</mn></msub></math></li>
</ul>

<p>100 ä¸ª featureï¼Œå¦‚ä½•æœ‰æ•ˆçš„é€‰å–è¿™äº›<code class="highlighter-rouge">Î¸</code>å‘¢ï¼Œæ”¹å˜ cost functionï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mstyle displaystyle="true">
    <mi>J</mi>
    <mo stretchy="false">(</mo>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mo stretchy="false">)</mo>
    <mo>=</mo>
    <mfrac>
      <mn>1</mn>
      <mrow>
        <mn>2</mn>
        <mi>m</mi>
      </mrow>
    </mfrac>
    <mfenced open="[" close="]">
      <mrow>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>m</mi>
        </munderover>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <msup>
          <mi>y</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <msup>
          <mo stretchy="false">)</mo>
          <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mi>&#x03BB;<!-- Î» --></mi>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>n</mi>
        </munderover>
        <msubsup>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
          <mn>2</mn>
        </msubsup>
      </mrow>
    </mfenced>
  </mstyle>
</math>

<p>å‚æ•° Î» å«åš<strong>regularization parameter</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ—¢è¦ä¿è¯æ›²çº¿çš„æ‹Ÿåˆç¨‹åº¦å¤Ÿé«˜åŒæ—¶åˆè¦ç¡®ä¿ Î¸ çš„å€¼å°½é‡å°ã€‚å¦‚æœ Î» çš„å€¼é€‰å–è¿‡å¤§ï¼Œä¾‹å¦‚<math><mi>Î»</mi><mo>=</mo><msup><mi>10</mi><mi>10</mi></msup></math>ï¼Œä¼šå¯¼è‡´è®¡ç®—å‡ºçš„æ‰€æœ‰çš„ Î¸ å€¼éƒ½æ¥è¿‘ 0ï¼Œä»è€Œä½¿<math><msub><mi>h</mi><mi>Î¸</mi></msub><mi>(x)</mi><mo>=</mo><msub><mi>Î¸</mi><mi>0</mi></msub></math> å³äº§ç”Ÿâ€Under fittingâ€</p>

<h3 id="regularized-linear-regression">Regularized linear regression</h3>

<p>æœ‰äº†ä¸Šé¢çš„å¼å­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒåº”ç”¨åˆ°çº¿æ€§å›å½’ï¼š</p>

<ul>
  <li>ä¿®æ”¹æ¢¯åº¦ä¸‹é™å…¬å¼ä¸ºï¼š</li>
</ul>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <mtext>Repeat</mtext>
        <mtext>&#xA0;</mtext>
        <mo fence="false" stretchy="false">{</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mn>0</mn>
        </msub>
        <mo>:=</mo>
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mn>0</mn>
        </msub>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>&#x03B1;<!-- Î± --></mi>
        <mtext>&#xA0;</mtext>
        <mfrac>
          <mn>1</mn>
          <mi>m</mi>
        </mfrac>
        <mtext>&#xA0;</mtext>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>m</mi>
        </munderover>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>h</mi>
          <mi>&#x03B8;<!-- Î¸ --></mi>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <msup>
          <mi>y</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <msubsup>
          <mi>x</mi>
          <mn>0</mn>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>i</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
        </msub>
        <mo>:=</mo>
        <msub>
          <mi>&#x03B8;<!-- Î¸ --></mi>
          <mi>j</mi>
        </msub>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>&#x03B1;<!-- Î± --></mi>
        <mtext>&#xA0;</mtext>
        <mfenced open="[" close="]">
          <mrow>
            <mfenced open="(" close=")">
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <mi>m</mi>
                </mfrac>
                <mtext>&#xA0;</mtext>
                <munderover>
                  <mo>&#x2211;<!-- âˆ‘ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>m</mi>
                </munderover>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>h</mi>
                  <mi>&#x03B8;<!-- Î¸ --></mi>
                </msub>
                <mo stretchy="false">(</mo>
                <msup>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>i</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
                <mo>&#x2212;<!-- âˆ’ --></mo>
                <msup>
                  <mi>y</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>i</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
                <msubsup>
                  <mi>x</mi>
                  <mi>j</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>i</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </mrow>
            </mfenced>
            <mo>+</mo>
            <mfrac>
              <mi>&#x03BB;<!-- Î» --></mi>
              <mi>m</mi>
            </mfrac>
            <msub>
              <mi>&#x03B8;<!-- Î¸ --></mi>
              <mi>j</mi>
            </msub>
          </mrow>
        </mfenced>
      </mtd>
      <mtd>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mi>j</mi>
        <mo>&#x2208;<!-- âˆˆ --></mo>
        <mo fence="false" stretchy="false">{</mo>
        <mn>1</mn>
        <mo>,</mo>
        <mn>2...</mn>
        <mi>n</mi>
        <mo fence="false" stretchy="false">}</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mo fence="false" stretchy="false">}</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>å°†<math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>Î»</mi><mi>m</mi></mfrac><msub><mi>Î¸</mi><mi>j</mi></msub></math>æå‡ºæ¥ï¼Œå¾—åˆ°:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>Î¸</mi>
    <mi>j</mi>
  </msub>
  <mo>:=</mo>
  <msub>
    <mi>Î¸</mi>
    <mi>j</mi>
  </msub>
  <mo stretchy="false">(</mo>
  <mn>1</mn>
  <mo>âˆ’</mo>
  <mi>Î±</mi>
  <mfrac>
    <mi>Î»</mi>
    <mi>m</mi>
  </mfrac>
  <mo stretchy="false">)</mo>
  <mo>âˆ’</mo>
  <mi>Î±</mi>
  <mfrac>
    <mn>1</mn>
    <mi>m</mi>
  </mfrac>
  <munderover>
    <mo>âˆ‘</mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>m</mi>
  </munderover>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>h</mi>
    <mi>Î¸</mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo>âˆ’</mo>
  <msup>
    <mi>y</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <msubsup>
    <mi>x</mi>
    <mi>j</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msubsup>
</math>

<p>ä¸Šè¿°å¼å­ä¸­<math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mfrac><mi>Î»</mi><mi>m</mi></mfrac></math>å¿…é¡»å°äº 1ï¼Œè¿™æ ·å°±å‡å°äº†<math><msub><mi>Î¸</mi><mi>j</mi></msub></math>çš„å€¼ï¼Œåé¢çš„å¼å­å’Œä¹‹å‰æ¢¯åº¦ä¸‹é™çš„å¼å­ç›¸åŒ</p>

<ul>
  <li>åº”ç”¨åˆ° Normal Equation</li>
</ul>

<p>å’Œä¹‹å‰çš„å…¬å¼ç›¸æ¯”ï¼Œå¢åŠ äº†ä¸€é¡¹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <mi>&#x03B8;<!-- Î¸ --></mi>
        <mo>=</mo>
        <msup>
          <mfenced open="(" close=")">
            <mrow>
              <msup>
                <mi>X</mi>
                <mi>T</mi>
              </msup>
              <mi>X</mi>
              <mo>+</mo>
              <mi>&#x03BB;<!-- Î» --></mi>
              <mo>&#x22C5;<!-- â‹… --></mo>
              <mi>L</mi>
            </mrow>
          </mfenced>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <msup>
          <mi>X</mi>
          <mi>T</mi>
        </msup>
        <mi>y</mi>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <mtext>where</mtext>
        <mtext>&#xA0;</mtext>
        <mtext>&#xA0;</mtext>
        <mi>L</mi>
        <mo>=</mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd />
              <mtd />
              <mtd />
              <mtd />
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mn>1</mn>
              </mtd>
              <mtd />
              <mtd />
              <mtd />
            </mtr>
            <mtr>
              <mtd />
              <mtd />
              <mtd>
                <mn>1</mn>
              </mtd>
              <mtd />
              <mtd />
            </mtr>
            <mtr>
              <mtd />
              <mtd />
              <mtd />
              <mtd>
                <mo>&#x22F1;<!-- â‹± --></mo>
              </mtd>
              <mtd />
            </mtr>
            <mtr>
              <mtd />
              <mtd />
              <mtd />
              <mtd />
              <mtd>
                <mn>1</mn>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>L æ˜¯ä¸€ä¸ªï¼ˆn+1)x(n+1)çš„å¯¹å•ä½é˜µï¼Œç¬¬ä¸€é¡¹æ˜¯ 0ã€‚åœ¨å¼•å…¥ Î».L ä¹‹å<math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><mo>+</mo><mi>Î»</mi><mi>L</mi></math>ä¿è¯å¯é€†</p>

<h3 id="regularized-logistic-regression">Regularized logistic regression</h3>

<p>é€»è¾‘å›å½’ä¹Ÿæœ‰ overfitting çš„é—®é¢˜ï¼Œå¦‚å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-5-7.png" alt="" /></p>

<p>å¤„ç†æ–¹å¼å’Œçº¿æ€§å›å½’ç›¸åŒï¼Œä¹‹å‰çŸ¥é“é€»è¾‘å›å½’çš„ cost function å¦‚ä¸‹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi>&#x03B8;<!-- Î¸ --></mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <mfrac>
    <mn>1</mn>
    <mi>m</mi>
  </mfrac>
  <munderover>
    <mo>&#x2211;<!-- âˆ‘ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>m</mi>
  </munderover>
  <mstyle mathsize="1.2em">
    <mo stretchy="false">[</mo>
    <msup>
      <mi>y</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mtext>&#xA0;</mtext>
    <mi>log</mi>
    <mo>&#x2061;<!-- â¡ --></mo>
    <mo stretchy="false">(</mo>
    <msub>
      <mi>h</mi>
      <mi>&#x03B8;<!-- Î¸ --></mi>
    </msub>
    <mo stretchy="false">(</mo>
    <msup>
      <mi>x</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mo stretchy="false">)</mo>
    <mo stretchy="false">)</mo>
    <mo>+</mo>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>&#x2212;<!-- âˆ’ --></mo>
    <msup>
      <mi>y</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mo stretchy="false">)</mo>
    <mtext>&#xA0;</mtext>
    <mi>log</mi>
    <mo>&#x2061;<!-- â¡ --></mo>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>&#x2212;<!-- âˆ’ --></mo>
    <msub>
      <mi>h</mi>
      <mi>&#x03B8;<!-- Î¸ --></mi>
    </msub>
    <mo stretchy="false">(</mo>
    <msup>
      <mi>x</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mo stretchy="false">)</mo>
    <mo stretchy="false">)</mo>
    <mstyle>
      <mo stretchy="false">]</mo>
    </mstyle>
  </mstyle>
</math>

<p>æˆ‘ä»¬å¯ä»¥åœ¨æœ€ååŠ ä¸€é¡¹æ¥ regularize è¿™ä¸ªå‡½æ•°ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi>&#x03B8;<!-- Î¸ --></mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <mfrac>
    <mn>1</mn>
    <mi>m</mi>
  </mfrac>
  <munderover>
    <mo>&#x2211;<!-- âˆ‘ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>m</mi>
  </munderover>
  <mstyle mathsize="1.2em">
    <mo stretchy="false">[</mo>
    <msup>
      <mi>y</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mtext>&#xA0;</mtext>
    <mi>log</mi>
    <mo>&#x2061;<!-- â¡ --></mo>
    <mo stretchy="false">(</mo>
    <msub>
      <mi>h</mi>
      <mi>&#x03B8;<!-- Î¸ --></mi>
    </msub>
    <mo stretchy="false">(</mo>
    <msup>
      <mi>x</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mo stretchy="false">)</mo>
    <mo stretchy="false">)</mo>
    <mo>+</mo>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>&#x2212;<!-- âˆ’ --></mo>
    <msup>
      <mi>y</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mo stretchy="false">)</mo>
    <mtext>&#xA0;</mtext>
    <mi>log</mi>
    <mo>&#x2061;<!-- â¡ --></mo>
    <mo stretchy="false">(</mo>
    <mn>1</mn>
    <mo>&#x2212;<!-- âˆ’ --></mo>
    <msub>
      <mi>h</mi>
      <mi>&#x03B8;<!-- Î¸ --></mi>
    </msub>
    <mo stretchy="false">(</mo>
    <msup>
      <mi>x</mi>
      <mrow class="MJX-TeXAtom-ORD">
        <mo stretchy="false">(</mo>
        <mi>i</mi>
        <mo stretchy="false">)</mo>
      </mrow>
    </msup>
    <mo stretchy="false">)</mo>
    <mo stretchy="false">)</mo>
    <mstyle>
      <mo stretchy="false">]</mo>
      <mo>+</mo>
      <mfrac>
        <mi>Î»</mi>
        <mrow>
          <mn>2</mn>
          <mi>m</mi>
        </mrow>
      </mfrac>
      <munderover>
        <mo>âˆ‘</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>j</mi>
          <mo>=</mo>
          <mn>1</mn>
        </mrow>
        <mi>n</mi>
      </munderover>
      <msubsup>
        <mi>Î¸</mi>
        <mi>j</mi>
        <mn>2</mn>
      </msubsup>
    </mstyle>
  </mstyle>
</math>

<p>ç¬¬äºŒé¡¹ï¼š<math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo>âˆ‘</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>Î¸</mi><mi>j</mi><mn>2</mn></msubsup></math>æ˜¯æ’é™¤äº†<math><msub><mi>Î¸</mi><mi>0</mi></msub></math>çš„ï¼Œå› æ­¤ï¼Œè®¡ç®—æ¢¯åº¦ä¸‹é™è¦å¯¹<math><msub><mi>Î¸</mi><mi>0</mi></msub></math>å•ç‹¬è®¡ç®—:</p>

<p><img src="/assets/images/2017/09/ml-5-8.png" alt="" /></p>

<ul>
  <li>Octave Demo</li>
</ul>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="p">[</span><span class="n">J</span><span class="p">,</span> <span class="n">grad</span><span class="p">]</span> <span class="o">=</span> <span class="n">lrCostFunction</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lambda</span><span class="p">{</span>

<span class="c1">%LRCOSTFUNCTION Compute cost and gradient for logistic regression with</span>
<span class="c1">%regularization</span>
<span class="c1">%   J = LRCOSTFUNCTION(theta, X, y, lambda) computes the cost of using</span>
<span class="c1">%   theta as the parameter for regularized logistic regression and the</span>
<span class="c1">%   gradient of the cost w.r.t. to the parameters.</span>

<span class="c1">% Initialize some useful values</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="c1">% number of training examples</span>

<span class="c1">% You need to return the following variables correctly</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">grad</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">theta</span><span class="p">));</span>



<span class="n">h</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">theta</span><span class="p">);</span> <span class="c1">%  X:118x28, theta:28x1 h:118x1</span>

<span class="c1">%å‘é‡åŒ–å®ç°</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="s1">'*log(h)-(1-y)'</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">h</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">lambda</span><span class="p">/</span><span class="n">m</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">theta</span><span class="p">([</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">])</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
<span class="c1">%ä»£æ•°å½¢å¼å®ç°</span>
<span class="c1">%J = 1/m * sum((-y).*log(h) - (1-y).*log(1-h)) + 0.5*lambda/m * sum(theta([2:end]).^2);</span>

<span class="n">grad</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">m</span> <span class="o">*</span> <span class="n">X</span><span class="o">'*</span><span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">y</span><span class="p">);</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">lambda</span><span class="p">/</span><span class="n">m</span> <span class="o">.*</span> <span class="n">theta</span><span class="p">;</span>
<span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">%skip theta(0)</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">grad</span> <span class="o">+</span> <span class="n">r</span><span class="p">;</span>


<span class="c1">% =============================================================</span>

<span class="n">grad</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(:);</span>

<span class="p">}</span>

<span class="k">function</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
	<span class="n">g</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">.</span><span class="p">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">));</span>
<span class="k">end</span>
</code></pre></div></div>
:ET