I"[º<blockquote>
  <p>æ–‡ä¸­æ‰€ç”¨åˆ°çš„å›¾ç‰‡éƒ¨åˆ†æˆªå–è‡ªAndrew Ngåœ¨<a href="https://www.coursera.org/learn/machine-learning">Couseraä¸Šçš„è¯¾ç¨‹</a></p>
</blockquote>

<h3 id="é€»è¾‘å›å½’çš„é—®é¢˜">é€»è¾‘å›å½’çš„é—®é¢˜</h3>

<p>ç¥ç»ç½‘ç»œç›®å‰æ˜¯ä¸€ä¸ªå¾ˆç«çš„æ¦‚å¿µï¼Œåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸç›®å‰è¿˜æ˜¯ä¸»æµï¼Œä¹‹å‰å·²ç»ä»‹ç»äº†çº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å­¦ä¹ ç¥ç»ç½‘ç»œï¼Ÿä»¥non-linear classificationä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-6-1.png" alt="" /></p>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„å»ºå¯¹featureçš„å¤šé¡¹å¼$g_\theta$æ¥ç¡®å®šé¢„æµ‹å‡½æ•°ï¼Œä½†è¿™ä¸­æ–¹æ³•é€‚ç”¨äºfeatureè¾ƒå°‘çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­ï¼Œåªæœ‰ä¸¤ä¸ªfeature: $x_1$å’Œ$x_2$ã€‚</p>

<p>å½“featureå¤šçš„æ—¶å€™ï¼Œäº§ç”Ÿå¤šé¡¹å¼å°±ä¼šå˜å¾—å¾ˆéº»çƒ¦ï¼Œè¿˜æ˜¯é¢„æµ‹æˆ¿ä»·çš„ä¾‹å­ï¼Œå¯èƒ½çš„featureæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š<code class="highlighter-rouge">x1=size</code>,<code class="highlighter-rouge">x2=#bedrooms</code>,<code class="highlighter-rouge">x3=#floors</code>,<code class="highlighter-rouge">x4=age</code>,â€¦<code class="highlighter-rouge">x100=#schools</code>ç­‰ç­‰ï¼Œå‡è®¾<code class="highlighter-rouge">n=100</code>ï¼Œæœ‰å‡ ç§åšæ³•ï¼š</p>

<ul>
  <li>æ„å»ºäºŒé˜¶å¤šé¡¹å¼
    <ul>
      <li>å¦‚$x_1^{2}$,$2x_1$,$3x_1$,â€¦,$x_2^{2}$,$3x_2$â€¦æœ‰çº¦ä¸º5000é¡¹(n^2/2)ï¼Œè®¡ç®—çš„ä»£ä»·éå¸¸é«˜ã€‚</li>
      <li>å–ä¸€ä¸ªå­é›†ï¼Œæ¯”å¦‚<code class="highlighter-rouge">x1^2, x2^2,x3^2...x100^2</code>ï¼Œè¿™æ ·å°±åªæœ‰100ä¸ªfeatureï¼Œä½†æ˜¯100ä¸ªfeatureä¼šå¯¼è‡´ç»“æœè¯¯å·®å¾ˆé«˜</li>
    </ul>
  </li>
  <li>æ„å»ºä¸‰é˜¶å¤šé¡¹å¼
    <ul>
      <li>å¦‚<code class="highlighter-rouge">x1x2x3, x1^2x2, x1^2x3...x10x11x17...</code>, æœ‰çº¦ä¸ºn^3é‡çº§çš„ç»„åˆæƒ…å†µï¼Œçº¦ä¸º170,000ä¸ª</li>
    </ul>
  </li>
</ul>

<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯å›¾åƒè¯†åˆ«ä¸åˆ†ç±»ï¼Œä¾‹å¦‚è¯†åˆ«ä¸€è¾†æ±½è½¦ï¼Œå¯¹äºå›¾åƒæ¥è¯´ï¼Œæ˜¯é€šè¿‡å¯¹åƒç´ å€¼è¿›è¡Œå­¦ä¹ ï¼ˆè½¦å…±æœ‰çš„åƒç´ ç‰¹å¾vséæ±½è½¦ç‰¹å¾ï¼‰ï¼Œé‚£ä¹ˆfeatureå°±æ˜¯å›¾ç‰‡çš„åƒç´ å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡å¦‚æœ‰ä¸¤ä¸ªåƒç´ ç‚¹æ˜¯è½¦å›¾ç‰‡éƒ½æœ‰çš„ï¼š</p>

<p><img src="/assets/images/2017/09/ml-6-2.png" alt="" /></p>

<p>å‡è®¾å›¾ç‰‡å¤§å°ä¸º50x50ï¼Œæ€»å…±2500ä¸ªåƒç´ ç‚¹ï¼Œå³2500ä¸ªfeatureï¼ˆç°åº¦å›¾åƒï¼ŒRGBä¹˜ä»¥ä¸‰ï¼‰ï¼Œå¦‚æœä½¿ç”¨äºŒæ¬¡æ–¹ç¨‹ï¼Œé‚£ä¹ˆæœ‰æ¥è¿‘300ä¸‡ä¸ªfeatureï¼Œæ˜¾ç„¶å›¾åƒè¿™ç§åœºæ™¯ä½¿ç”¨non linear regressionä¸åˆé€‚ï¼Œéœ€è¦æ¢ç´¢æ–°çš„å­¦ä¹ æ–¹å¼</p>

<h3 id="å•å±‚ç¥ç»ç½‘ç»œ">å•å±‚ç¥ç»ç½‘ç»œ</h3>

<p>æ‰€è°“ç¥ç»å…ƒ(Neuron)å°±æ˜¯ä¸€ç§è®¡ç®—å•å…ƒï¼Œå®ƒçš„è¾“å…¥æ˜¯ä¸€ç»„ç‰¹å¾ä¿¡æ¯$x_1$â€¦$x_n$ï¼Œè¾“å‡ºä¸ºé¢„æµ‹å‡½æ•°çš„ç»“æœã€‚</p>

<p><img src="/assets/images/2017/09/ml-6-4.png" alt="" /></p>

<p>å¦‚ä¸Šå›¾ï¼Œæ˜¯ä¸€ä¸ªå•å±‚çš„ç¥ç»ç½‘ç»œï¼Œå…¶ä¸­ï¼š</p>

<ul>
  <li>è¾“å…¥ç«¯$x_0$é»˜è®¤ä¸º1ï¼Œä¹Ÿå«åšâ€bias unit.â€</li>
  <li>$\theta$çŸ©é˜µåœ¨ç¥ç»ç½‘ç»œé‡Œä¹Ÿè¢«å«åšæƒé‡weightçŸ©é˜µ</li>
</ul>

<p>å¯¹äºä¸Šè¿°å•å±‚ç¥ç»ç½‘ç»œçš„è¾“å‡ºå‡½æ•°$h_\theta(x)$ï¼Œå¯ä»¥è¡¨ç¤ºä¸º</p>

<script type="math/tex; mode=display">h_\theta(x) = g(\theta^Tx) = g(\theta_0 + \theta_1x_1 + \theta_2x_2 + \theta_3x_3 + \theta_4x_4)</script>

<p>å…¶ä¸­ï¼Œ$\theta_0$ä¸ºbias uintï¼Œ<code class="highlighter-rouge">g</code>ä¸ºsigmoidå‡½æ•°$\frac{1}{1+e^{-z}}$ï¼Œä½œç”¨æ˜¯å°†è¾“å‡ºçš„å€¼æ˜ å°„åˆ°<code class="highlighter-rouge">[0,1]</code>ä¹‹é—´ã€‚å› æ­¤æœ€ç»ˆçš„è¾“å‡ºå‡½æ•°ä¹Ÿå¯ä»¥å†™ä½œ</p>

<script type="math/tex; mode=display">h_\theta(x) = \frac{1}{1+e^{-\theta^Tx}}</script>

<p>å…¬å¼æœ‰äº›æŠ½è±¡ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨Pytorchæ¥å®ç°</p>

<pre><code class="language-Python">import torch

def activation(x):
    return 1 / (1+torch.exp(-x))

## Generate some data
torch.manual_seed(7) #set the random seed so things are predictable

## Features are 5 random normal variables
features = torch.randn((1,5)) #1x5

# True weights for our data, random normal variables again
# same shape as features
weights = torch.randn_like(features) #1x5

#and a true bias term
bias = torch.randn((1,1))

# weights.view will convert the matrix to 5x1
# torch.mm does the matrxi multiplication
y = activation(bias + torch.mm(features, weights.view(5,1)))
</code></pre>

<h3 id="å¤šå±‚ç¥ç»ç½‘ç»œ">å¤šå±‚ç¥ç»ç½‘ç»œ</h3>

<p>ä¸Šè¿°çš„ç¥ç»ç½‘ç»œåªæœ‰è¾“å‡ºç«¯ä¸€ä¸ªNeuronï¼Œå±äºæ¯”è¾ƒç®€å•çš„ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªå¤šä¸ªNeuronçš„ä¸¤å±‚ç¥ç»ç½‘ç»œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-6-5.png" alt="" /></p>

<p>ä¸Šè¿°ç¥ç»ç½‘ç»œä¸­çš„ç¬¬ä¸€å±‚æ˜¯å«â€Input Layerâ€ï¼Œæœ€åä¸€å±‚å«â€Output Layerâ€ï¼Œä¸­é—´å«â€Hidden Layerâ€ï¼Œç”¨$a_0^2â€¦a_n^2$è¡¨ç¤ºï¼Œä»–ä»¬ä¹Ÿå«åšâ€activation units.â€ å…¶ä¸­</p>

<ul>
  <li>è¾“å…¥å±‚çš„$x_i$ä¸ºæ ·æœ¬featureï¼Œ$x_0$ä½œä¸ºâ€biasâ€</li>
  <li>ä¸­é—´å±‚çš„$a_i^{(j)}$ è¡¨ç¤ºç¬¬<code class="highlighter-rouge">j</code>å±‚çš„ç¬¬<code class="highlighter-rouge">i</code>ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åŠ å…¥$a_0^{(2)}$ä½œä¸ºâ€bias unitâ€ï¼Œä¹Ÿå¯ä»¥å¿½ç•¥</li>
</ul>

<script type="math/tex; mode=display">\begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
\end{bmatrix}
\to
\begin{bmatrix}
a_1^{(2)} \\
a_2^{(2)} \\
a_3^{(2)} \\
\end{bmatrix}
\to
h_\theta(x)</script>

<p>å¯¹ç¬¬äºŒå±‚æ¯ä¸ªactivationèŠ‚ç‚¹çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>

<script type="math/tex; mode=display">a_1^{(2)} = g(\theta_{10}^{(1)}x_0 + \theta_{11}^{(1)}x_1 + \theta_{12}^{(1)}x_2 + \theta_{13}^{(1)}x_3 ) \\
a_2^{(2)} = g(\theta_{20}^{(1)}x_0 + \theta_{21}^{(1)}x_1 + \theta_{22}^{(1)}x_2 + \theta_{23}^{(1)}x_3 ) \\
a_3^{(2)} = g(\theta_{30}^{(1)}x_0 + \theta_{31}^{(1)}x_1 + \theta_{32}^{(1)}x_2 + \theta_{33}^{(1)}x_3 ) \\
h_\theta(x) = a_1^{(3)} = g(\theta_{10}^{(2)}a_0^{2}+\theta_{11}^{(2)}a_1^{2}+\theta_{12}^{(2)}a_2^{2}+\theta_{13}^{(2)}a_3^{2})</script>

<p>ä¸Šé¢å¯ä»¥çœ‹åˆ°ç¬¬ä¸€å±‚Hidden Layerçš„å‚æ•°ï¼Œ$\theta_{ij}$è¡¨ç¤ºä»èŠ‚ç‚¹<code class="highlighter-rouge">i</code>åˆ°èŠ‚ç‚¹<code class="highlighter-rouge">j</code>çš„æƒé‡å€¼ï¼Œ$\theta^{(l)}$è¡¨ç¤ºè¯¥æƒé‡ä½äºç¬¬<code class="highlighter-rouge">l</code>å±‚ã€‚å¦‚æœå•ç‹¬çœ‹æ¯ä¸€ä¸ª<code class="highlighter-rouge">a</code>èŠ‚ç‚¹çš„å€¼ï¼Œä¼šå‘ç°å®ƒå’Œä¸Šè¿°å•å±‚ç¥ç»ç½‘ç»œçš„è®¡ç®—æ–¹å¼ä¸€æ ·ï¼Œéœ€è¦ä¸€ä¸ªbias unitå’Œ$\theta$æƒé‡ã€‚ å¦‚ä¸Šå›¾ä¸­çš„$\theta$çŸ©é˜µæ˜¯<code class="highlighter-rouge">3x4</code>çš„ï¼Œè¾“å…¥çš„featureçŸ©é˜µæ˜¯<code class="highlighter-rouge">4x1</code>çš„ï¼Œè¿™æ ·ç›¸ä¹˜å¾—å‡ºçš„ç¬¬ä¸€å±‚è¾“å‡ºçŸ©é˜µæ˜¯<code class="highlighter-rouge">3x1</code>çš„ï¼Œå¯¹åº”æ¯ä¸ª<code class="highlighter-rouge">a</code>èŠ‚ç‚¹çš„å€¼ã€‚è€Œæ•´ä¸ªç¥ç»ç½‘ç»œæœ€ç»ˆè¾“å‡ºç»“æœæ˜¯ç¥ç»å…ƒ<code class="highlighter-rouge">a</code>çŸ©é˜µå†ä¹˜ä»¥ç¬¬äºŒå±‚Hidden Layerçš„å‚æ•°çŸ©é˜µ$\theta^{(2)}$ã€‚ç”±æ­¤æˆ‘ä»¬å¯ä»¥æ¨æµ‹å‡º$\theta$çŸ©é˜µçš„ç»´åº¦çš„è®¡ç®—æ–¹å¼ä¸º:</p>

<blockquote>
  <p>å¦‚æœç¥ç»ç½‘ç»œç¬¬<code class="highlighter-rouge">j</code>å±‚æœ‰$m$ä¸ªå•å…ƒï¼Œç¬¬<code class="highlighter-rouge">j+1</code>å±‚æœ‰$n$ä¸ªå•å…ƒï¼Œé‚£ä¹ˆ$\Theta$çŸ©é˜µçš„ç»´åº¦ä¸º$n \times (m+1)$</p>
</blockquote>

<p>ä»¥ä¸Šé¢çš„ä¾‹å­æ¥è¯´, å¦‚æœlayer1æœ‰ä¸¤ä¸ªä¸‰ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼Œå³$m=3$, layer2 æœ‰ä¸‰ä¸ªactivationèŠ‚ç‚¹ï¼Œå³$n=3$ã€‚é‚£ä¹ˆ$\Theta$çŸ©é˜µæ˜¯<code class="highlighter-rouge">3x4</code>çš„ã€‚ ä¸ºä»€ä¹ˆè¦+1å‘¢ï¼Ÿ åŸå› æ˜¯åœ¨è¾“å…¥å±‚(input layer)è¦å¼•å…¥$x_0$ä½œä¸ºbias, å¯¹åº”</p>

<p>ä¸ºäº†ç®€åŒ–ä¸Šé¢Hidden Layerçš„å¼å­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°çš„å˜é‡$z_k^{(j)}$æ¥è¡¨ç¤º<code class="highlighter-rouge">g</code>å‡½æ•°çš„å‚æ•°ï¼Œåˆ™ä¸Šè¿°èŠ‚ç‚¹<code class="highlighter-rouge">a</code>çš„å€¼å¯è¡¨ç¤ºå¦‚ä¸‹ï¼š</p>

<script type="math/tex; mode=display">a_1^{(2)} = g(z_1^{(2)}) \\
a_2^{(2)} = g(z_2^{(2)}) \\
a_3^{(2)} = g(z_3^{(2)}) \\
a_1^{(3)} = g(z_3^{(2)})</script>

<p>å’Œå‰é¢ä¸€æ ·ï¼Œä¸Šè„šæ ‡ç”¨æ¥è¡¨ç¤ºç¬¬å‡ å±‚layerï¼Œä¸‹è„šæ ‡ç”¨æ¥è¡¨ç¤ºè¯¥layerçš„ç¬¬å‡ ä¸ªèŠ‚ç‚¹ã€‚ä¾‹å¦‚<code class="highlighter-rouge">j=2</code>æ—¶çš„ç¬¬<code class="highlighter-rouge">k</code>ä¸ªèŠ‚ç‚¹çš„å€¼ä¸º</p>

<script type="math/tex; mode=display">a_k^{(2)} = g(z_k^{(2)}) \\
z_k^{(1)} = \theta_{k0}^{(1)}x_0 + \theta_{k1}^{(1)}x_1 + ... + \theta_{kn}^{(1)}x_n</script>

<p>å°†ä¸Šé¢å¼å­åšè¿›ä¸€æ­¥æ¨å¯¼å¹¶ç”¨å‘é‡è¡¨ç¤ºä¸º</p>

<script type="math/tex; mode=display">a^{(j)} = g(z^{(j-1)}) \\
z^{(j-1)} = \theta^{(j-1)}a^{(j-1)}</script>

<p>æˆ‘ä»¬ç”¨ç»“åˆä¸Šé¢çš„ä¸‰å±‚ç¥ç»ç½‘ç»œæ¥ç®€å•éªŒè¯ä¸‹ï¼Œå‡è®¾<code class="highlighter-rouge">j=3</code>é‚£ä¹ˆç¬¬ä¸‰å±‚ç¥ç»ç½‘ç»œèŠ‚ç‚¹çš„å€¼$z^{(3)}$ä¸º</p>

<script type="math/tex; mode=display">z^{(3)} = \theta^{(2)}a^{(2)}
h_\theta(x) = a^{(3)} = g(z)</script>

<p>å…¶ä¸­ï¼Œä¸Šè§’æ ‡ç”¨æ¥è¡¨ç¤ºç¬¬å‡ å±‚layerï¼Œä¸‹è§’æ ‡è¡¨ç¤ºè¯¥å±‚çš„ç¬¬å‡ ä¸ªèŠ‚ç‚¹ã€‚ä¾‹å¦‚ç¬¬2å±‚çš„ç¬¬kä¸ªèŠ‚ç‚¹çš„zå€¼ä¸ºï¼š</p>

<script type="math/tex; mode=display">z_k^{(2)} =</script>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msubsup>
    <mi>z</mi>
    <mi>k</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msubsup>
  <mo>=</mo>
  <msubsup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>k</mi>
      <mo>,</mo>
      <mn>0</mn>
    </mrow>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msubsup>
  <msub>
    <mi>x</mi>
    <mn>0</mn>
  </msub>
  <mo>+</mo>
  <msubsup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>k</mi>
      <mo>,</mo>
      <mn>1</mn>
    </mrow>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msubsup>
  <msub>
    <mi>x</mi>
    <mn>1</mn>
  </msub>
  <mo>+</mo>
  <mo>&#x22EF;<!-- â‹¯ --></mo>
  <mo>+</mo>
  <msubsup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>k</mi>
      <mo>,</mo>
      <mi>n</mi>
    </mrow>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msubsup>
  <msub>
    <mi>x</mi>
    <mi>n</mi>
  </msub>
</math>

<p>ç”¨å‘é‡è¡¨ç¤ºxå’Œ<math><msup><mi>z</mi><mrow><mi>j</mi></mrow></msup></math>å¦‚ä¸‹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd>
        <mi>x</mi>
        <mo>=</mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>&#x22EF;<!-- â‹¯ --></mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mi>n</mi>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
      </mtd>
      <mtd>
        <msup>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>j</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo>=</mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msubsup>
                  <mi>z</mi>
                  <mn>1</mn>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>j</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msubsup>
                  <mi>z</mi>
                  <mn>2</mn>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>j</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>&#x22EF;<!-- â‹¯ --></mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msubsup>
                  <mi>z</mi>
                  <mi>n</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>j</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>ä»¤xä¸ºç¬¬ä¸€å±‚èŠ‚ç‚¹<math><mi>x</mi><mo>=</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></math>ï¼Œåˆ™æ¯å±‚çš„å‘é‡åŒ–è¡¨ç¤ºä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <msup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo>&#x2212;<!-- âˆ’ --></mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <msup>
    <mi>a</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo>&#x2212;<!-- âˆ’ --></mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
</math>

<p>å…¶ä¸­ï¼Œ<math><msup><mi>Î˜</mi><mi>(j-1)</mi></msup></math>æ˜¯ jx(j+1) çš„ï¼Œ<math><msup><mi>a</mi><mi>(j-1)</mi></msup></math>æ˜¯(j+1)x1çš„ï¼Œå› æ­¤<math><msup><mi>z</mi><mi>j</mi></msup></math>æ˜¯jx1çš„ï¼Œå³</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi>a</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <mi>g</mi>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
</math>

<p>å½“æˆ‘ä»¬è®¡ç®—å®Œ<math><msup><mi>a</mi><mi>(j)</mi></msup></math>åï¼Œæˆ‘ä»¬å¯ä»¥ç»™<math><msup><mi>a</mi><mi>(j)</mi></msup></math>å¢åŠ ä¸€ä¸ªbias unitï¼Œå³<math><msubsup><mi>a</mi><mn>0</mn><mi>(j)</mi></msubsup><mo>=</mo><mn>1</mn></math>ï¼Œåˆ™aå˜æˆäº†(j+1)x1çš„ã€‚ä»¥æ­¤ç±»æ¨ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo>+</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <msup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <msup>
    <mi>a</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
</math>

<p>æœ€ç»ˆçš„é¢„æµ‹å‡½æ•°hè¡¨ç¤ºä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>h</mi>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
  </msub>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <msup>
    <mi>a</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo>+</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <mi>g</mi>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>j</mi>
      <mo>+</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
</math>

<p>æ³¨æ„åˆ°åœ¨æ¯å±‚çš„è®¡ç®—ä¸Šï¼Œæˆ‘ä»¬çš„é¢„æµ‹å‡½æ•°å’Œé€»è¾‘å›å½’åŸºæœ¬ç›¸åŒã€‚æˆ‘ä»¬å¢åŠ äº†è¿™ä¹ˆå¤šå±‚ï¼Œå³ç¥ç»ç½‘ç»œæ˜¯ä¸ºäº†æ›´å¥½çš„å¾—åˆ°éçº¿æ€§å‡½æ•°çš„é¢„æµ‹ç»“æœï¼Œè¿™ä¸ªç®—æ³•ä¹Ÿå«åš<strong>Forward Propagation</strong>ï¼Œåé¢ç®€ç§°<strong>FB</strong>ç®—æ³•ï¼ŒOctaveå®ç°ä¸ºï¼š</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">function</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
	<span class="n">g</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">.</span><span class="p">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">));</span>
<span class="k">end</span>

<span class="k">function</span> <span class="n">p</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">Theta1</span><span class="p">,</span> <span class="n">Theta2</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">num_labels</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">Theta2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">% You need to return the following variables correctly </span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>

<span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">X</span><span class="p">];</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">Theta1</span><span class="o">'</span><span class="p">);</span>
<span class="n">a2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ones</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="n">a2</span><span class="p">];</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">a2</span><span class="o">*</span><span class="n">Theta2</span><span class="o">'</span><span class="p">);</span>

<span class="c1">% Hint: The max function might come in useful. In particular, the max</span>
<span class="c1">%       function can also return the index of the max element, for more</span>
<span class="c1">%       information see 'help max'. If your examples are in rows, then, you</span>
<span class="c1">%       can use max(A, [], 2) to obtain the max for each row.</span>
<span class="c1">%</span>
<span class="p">[</span><span class="nb">max</span><span class="p">,</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">,[],</span><span class="mi">2</span><span class="p">);</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">index</span><span class="p">;</span>

<span class="k">end</span>

</code></pre></div></div>

<h3 id="neural-network-example">Neural Network Example</h3>

<ul>
  <li>å•å±‚ç¥ç»ç½‘ç»œå®ç°ä¸æˆ–é—¨</li>
</ul>

<p>ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªç®€å•åº”ç”¨æ˜¯é¢„æµ‹<math><msub><mi>x</mi><mn>1</mn></msub></math> AND <math><msub><mi>x</mi><mn>2</mn></msub></math>ï¼Œå½“<math><msub><mi>x</mi><mn>1</mn></msub></math>å’Œ<math><msub><mi>x</mi><mn>2</mn></msub></math>éƒ½ä¸º1çš„æ—¶å€™ï¼Œç»“æœæ˜¯trueï¼Œé¢„æµ‹å‡½æ•°å¦‚ä¸‹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>2</mn>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
        <mo stretchy="false">&#x2192;<!-- â†’ --></mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mi>g</mi>
                <mo stretchy="false">(</mo>
                <msup>
                  <mi>z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mn>2</mn>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
        <mo stretchy="false">&#x2192;<!-- â†’ --></mo>
        <msub>
          <mi>h</mi>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<math><msub><mi>x</mi><mn>0</mn></msub></math>
<p>ä¸º1ï¼Œæˆ‘ä»¬å‡è®¾ <math><msup><mi>Î¸</mi><mi>(1)</mi></msup></math>çš„å€¼å¦‚ä¸‹ï¼š<math><msup><mi>Î˜</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo stretchy="false">[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>âˆ’</mo><mn>30</mn></mtd><mtd><mn>20</mn></mtd><mtd><mn>20</mn></mtd></mtr></mtable><mo stretchy="false">]</mo></math></p>

<p><img src="/assets/images/2017/09/ml-6-7.png" alt="" /></p>

<p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªä¸€å±‚çš„ç¥ç»ç½‘ç»œæ¥å¤„ç†è®¡ç®—æœºçš„â€ANDâ€è¯·æ±‚ï¼Œæ¥ä»£æ›¿åŸæ¥çš„â€œä¸é—¨â€ã€‚ç¥ç»ç½‘ç»œå¯ç”¨æ¥æ„å»ºæ‰€æœ‰çš„é€»è¾‘é—¨ï¼Œæ¯”å¦‚â€ORâ€è¿ç®—å¦‚ä¸‹å›¾ï¼š</p>

<p><img src="/assets/images/2017/09/ml-6-8.png" alt="" /></p>

<ul>
  <li>äºŒçº§ç¥ç»ç½‘ç»œæ„å»ºåŒæˆ–é—¨</li>
</ul>

<p>ä¸Šé¢æˆ‘ä»¬å®ç°äº†ä¸æˆ–é(éçš„æ¨å¯¼å¿½ç•¥)ï¼Œå¯¹åº”çš„thetaçŸ©é˜µå¦‚ä¸‹ï¼š</p>

<p><br />&lt;/br&gt;</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd>
        <mi>A</mi>
        <mi>N</mi>
        <mi>D</mi>
        <mo>:</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
      </mtd>
      <mtd>
        <mo>=</mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mo>&#x2212;<!-- âˆ’ --></mo>
                <mn>30</mn>
              </mtd>
              <mtd>
                <mn>20</mn>
              </mtd>
              <mtd>
                <mn>20</mn>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mi>N</mi>
        <mi>O</mi>
        <mi>R</mi>
        <mo>:</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
      </mtd>
      <mtd>
        <mo>=</mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mn>10</mn>
              </mtd>
              <mtd>
                <mo>&#x2212;<!-- âˆ’ --></mo>
                <mn>20</mn>
              </mtd>
              <mtd>
                <mo>&#x2212;<!-- âˆ’ --></mo>
                <mn>20</mn>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mi>O</mi>
        <mi>R</mi>
        <mo>:</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
      </mtd>
      <mtd>
        <mo>=</mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mo>&#x2212;<!-- âˆ’ --></mo>
                <mn>10</mn>
              </mtd>
              <mtd>
                <mn>20</mn>
              </mtd>
              <mtd>
                <mn>20</mn>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢çš„çŸ©é˜µæ¥æ„å»ºXNORé—¨ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>x</mi>
                  <mn>2</mn>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
        <mo stretchy="false">&#x2192;<!-- â†’ --></mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msubsup>
                  <mi>a</mi>
                  <mn>1</mn>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mn>2</mn>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msubsup>
                  <mi>a</mi>
                  <mn>2</mn>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mn>2</mn>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
        <mo stretchy="false">&#x2192;<!-- â†’ --></mo>
        <mfenced open="[" close="]">
          <mtable rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msup>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mn>3</mn>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
          </mtable>
        </mfenced>
        <mo stretchy="false">&#x2192;<!-- â†’ --></mo>
        <msub>
          <mi>h</mi>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>ç¬¬ä¸€å±‚èŠ‚ç‚¹çš„Î¸çŸ©é˜µä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>1</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <mfenced open="[" close="]">
    <mtable rowspacing="4pt" columnspacing="1em">
      <mtr>
        <mtd>
          <mo>&#x2212;<!-- âˆ’ --></mo>
          <mn>30</mn>
        </mtd>
        <mtd>
          <mn>20</mn>
        </mtd>
        <mtd>
          <mn>20</mn>
        </mtd>
      </mtr>
      <mtr>
        <mtd>
          <mn>10</mn>
        </mtd>
        <mtd>
          <mo>&#x2212;<!-- âˆ’ --></mo>
          <mn>20</mn>
        </mtd>
        <mtd>
          <mo>&#x2212;<!-- âˆ’ --></mo>
          <mn>20</mn>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>

<p>ç¬¬äºŒå±‚èŠ‚ç‚¹çš„Î¸çŸ©é˜µä¸º:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <mfenced open="[" close="]">
    <mtable rowspacing="4pt" columnspacing="1em">
      <mtr>
        <mtd>
          <mo>&#x2212;<!-- âˆ’ --></mo>
          <mn>10</mn>
        </mtd>
        <mtd>
          <mn>20</mn>
        </mtd>
        <mtd>
          <mn>20</mn>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>

<p>æ¯å±‚èŠ‚ç‚¹çš„è®¡ç®—ç”¨å‘é‡åŒ–è¡¨ç¤ºä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em 2em 0.278em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd />
      <mtd>
        <msup>
          <mi>a</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>2</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo>=</mo>
        <mi>g</mi>
        <mo stretchy="false">(</mo>
        <msup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo>&#x22C5;<!-- â‹… --></mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <msup>
          <mi>a</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>3</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo>=</mo>
        <mi>g</mi>
        <mo stretchy="false">(</mo>
        <msup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>2</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo>&#x22C5;<!-- â‹… --></mo>
        <msup>
          <mi>a</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>2</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
      </mtd>
    </mtr>
    <mtr>
      <mtd />
      <mtd>
        <msub>
          <mi>h</mi>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>x</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msup>
          <mi>a</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mn>3</mn>
            <mo stretchy="false">)</mo>
          </mrow>
        </msup>
      </mtd>
    </mtr>
  </mtable>
</math>

<p><img src="/assets/images/2017/09/ml-6-9.png" alt="" /></p>

<h3 id="multiclass-classification">Multiclass Classification</h3>

<p>ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œå¤šç§ç±»å‹åˆ†ç±»çš„é—®é¢˜ï¼Œæˆ‘ä»¬å‡è®¾æœ€åçš„è¾“å‡ºæ˜¯ä¸€ä¸ªå‘é‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-6-10.png" alt="" /></p>

<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯¹äºè¾“å‡ºç»“æœyçš„å¯èƒ½æƒ…å†µæœ‰ï¼š</p>

<p><img src="/assets/images/2017/09/ml-6-11.png" alt="" /></p>

<p>æ¯ä¸€ä¸ª<math><msup><mi>y</mi><mi>(i)</mi></msup></math>å‘é‡ä»£è¡¨ä¸€ä¸­åˆ†ç±»ç»“æœï¼ŒæŠ½è±¡æ¥çœ‹ï¼Œå¤šçº§ç¥ç»ç½‘ç»œåˆ†ç±»å¯å¦‚ä¸‹è¡¨ç¤ºï¼š</p>

<p><img src="/assets/images/2017/09/ml-6-12.png" alt="" /></p>

<h3 id="cost-function">Cost Function</h3>

<ul>
  <li>å…ˆå®šä¹‰ä¸€äº›å˜é‡:
    <ul>
      <li>L = ç¥ç»ç½‘ç»œçš„å±‚æ•°</li>
      <li>
        <math><msub><mi>S</mi><mi>l</mi></msub></math>
        <p>= ç¬¬lå±‚çš„èŠ‚ç‚¹æ•°</p>
      </li>
      <li>K = è¾“å‡ºå±‚çš„èŠ‚ç‚¹æ•°ï¼Œå³è¾“å‡ºç»“æœçš„ç§ç±»ã€‚
        <ul>
          <li>å¯¹0å’Œ1çš„åœºæ™¯ï¼ŒK=1ï¼Œ <math><msub><mi>S</mi><mi>l</mi></msub><mo>=</mo><mn>1</mn></math></li>
          <li>å¯¹äºå¤šç§åˆ†ç±»çš„åœºæ™¯ï¼ŒK&gt;=3ï¼Œ <math><msub><mi>S</mi><mi>l</mi></msub><mo>=</mo><mi>K</mi></math></li>
          <li>ç”¨<math><msub><mi>h</mi><mi>Î˜</mi></msub><mo stretchy="false">(</mo><mi>x</mi><msub><mo stretchy="false">)</mo><mi>k</mi></msub></math>è¡¨ç¤ºç¬¬Kä¸ªåˆ†ç±»çš„è®¡ç®—ç»“æœ</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Cost Function</li>
</ul>

<p>å‚è€ƒä¹‹å‰çš„é€»è¾‘å›å½’costå‡½æ•°ï¼š</p>

<math display="block">
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi>&#x03B8;<!-- Î¸ --></mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <mfrac>
    <mn>1</mn>
    <mi>m</mi>
  </mfrac>
  <munderover>
    <mo>&#x2211;<!-- âˆ‘ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>i</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>m</mi>
  </munderover>
  <mo stretchy="false">[</mo>
  <msup>
    <mi>y</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mtext>&#xA0;</mtext>
  <mi>log</mi>
  <mo>&#x2061;<!-- â¡ --></mo>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>h</mi>
    <mi>&#x03B8;<!-- Î¸ --></mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo stretchy="false">)</mo>
  <mo>+</mo>
  <mo stretchy="false">(</mo>
  <mn>1</mn>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <msup>
    <mi>y</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mtext>&#xA0;</mtext>
  <mi>log</mi>
  <mo>&#x2061;<!-- â¡ --></mo>
  <mo stretchy="false">(</mo>
  <mn>1</mn>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <msub>
    <mi>h</mi>
    <mi>&#x03B8;<!-- Î¸ --></mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo stretchy="false">)</mo>
  <mo stretchy="false">]</mo>
  <mo>+</mo>
  <mfrac>
    <mi>&#x03BB;<!-- Î» --></mi>
    <mrow>
      <mn>2</mn>
      <mi>m</mi>
    </mrow>
  </mfrac>
  <munderover>
    <mo>&#x2211;<!-- âˆ‘ --></mo>
    <mrow class="MJX-TeXAtom-ORD">
      <mi>j</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>n</mi>
  </munderover>
  <msubsup>
    <mi>&#x03B8;<!-- Î¸ --></mi>
    <mi>j</mi>
    <mn>2</mn>
  </msubsup>
</math>

<p>å¯¹ç¥ç»ç½‘ç»œæ¥è¯´ï¼Œè¾“å‡ºç»“æœä¸å†åªæœ‰ä¸¤ç§ç±»å‹ï¼Œè€Œæ˜¯æœ‰Kç§åˆ†ç±»ï¼Œcostå‡½æ•°ä¹Ÿæ›´åŠ æŠ½è±¡å’Œå¤æ‚ï¼š</p>

<math display="block">
  <mtable rowspacing="3pt" columnspacing="1em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mfrac>
          <mn>1</mn>
          <mi>m</mi>
        </mfrac>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>m</mi>
        </munderover>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>K</mi>
        </munderover>
        <mfenced open="[" close="]">
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mi>k</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msubsup>
            <mi>log</mi>
            <mo>&#x2061;<!-- â¡ --></mo>
            <mo stretchy="false">(</mo>
            <mo stretchy="false">(</mo>
            <msub>
              <mi>h</mi>
              <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
            </msub>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>x</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msup>
            <mo stretchy="false">)</mo>
            <msub>
              <mo stretchy="false">)</mo>
              <mi>k</mi>
            </msub>
            <mo stretchy="false">)</mo>
            <mo>+</mo>
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <msubsup>
              <mi>y</mi>
              <mi>k</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msubsup>
            <mo stretchy="false">)</mo>
            <mi>log</mi>
            <mo>&#x2061;<!-- â¡ --></mo>
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <mo stretchy="false">(</mo>
            <msub>
              <mi>h</mi>
              <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
            </msub>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>x</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msup>
            <mo stretchy="false">)</mo>
            <msub>
              <mo stretchy="false">)</mo>
              <mi>k</mi>
            </msub>
            <mo stretchy="false">)</mo>
          </mrow>
        </mfenced>
        <mo>+</mo>
        <mfrac>
          <mi>&#x03BB;<!-- Î» --></mi>
          <mrow>
            <mn>2</mn>
            <mi>m</mi>
          </mrow>
        </mfrac>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>l</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>L</mi>
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <mn>1</mn>
          </mrow>
        </munderover>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>s</mi>
              <mi>l</mi>
            </msub>
          </mrow>
        </munderover>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>s</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>l</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
          </mrow>
        </munderover>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>,</mo>
            <mi>i</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>l</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
        <msup>
          <mo stretchy="false">)</mo>
          <mn>2</mn>
        </msup>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>ä¸ºäº†è®¡ç®—å¤šä¸ªè¾“å‡ºç»“æœï¼Œæ‹¬å·å‰çš„æ±‚å’Œè¡¨ç¤ºå¯¹Kå±‚åˆ†åˆ«è¿›è¡Œè®¡ç®—åå†ç´¯åŠ è®¡ç®—ç»“æœã€‚ä¸­æ‹¬å·åé¢æ˜¯regularizationé¡¹ï¼Œæ˜¯æ¯å±‚Î¸çŸ©é˜µå…ƒç´ çš„å¹³æ–¹å’Œç´¯åŠ ï¼Œå…¬å¼é‡Œå„å±‚Î¸çŸ©é˜µçš„åˆ—æ•°ç­‰åŒäºå¯¹åº”å±‚çš„èŠ‚ç‚¹æ•°ï¼Œè¡Œæ•°ç­‰å®ƒå¯¹åº”å±‚çš„èŠ‚ç‚¹æ•°+1ï¼Œå…¶ä¸­<math><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>s</mi><mi>l</mi></msub></mrow></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>s</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></munderover><mo stretchy="false">(</mo><msubsup><mi>Î˜</mi><mrow><mi>j</mi><mo>,</mo><mi>i</mi></mrow><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math>æ˜¯æ¯ä¸ªÎ¸çŸ©é˜µé¡¹çš„å¹³æ–¹å’Œï¼Œ<math><munderover><mo>âˆ‘</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>-</mo><mn>1</mn></mrow></munderover></math>ä»£è¡¨å„ä¸ªå±‚Î¸çŸ©é˜µçš„å¹³æ–¹å’Œç´¯åŠ ã€‚ç†è§£äº†è¿™ä¸¤éƒ¨åˆ†å°±ä¸éš¾ç†è§£regularizationé¡¹äº†ï¼Œå®ƒå’Œä¹‹å‰é€»è¾‘å›å½’çš„regularizationé¡¹æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚</p>

<p>ç†è§£ä¸Šè¿°å¼å­ç€é‡è®°ä½ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p>

<ol>
  <li>å‰ä¸¤ä¸ªæ±‚å’Œç¬¦å·æ˜¯å¯¹æ¯å±‚ç¥ç»ç½‘ç»œèŠ‚ç‚¹è¿›è¡Œé€»è¾‘å›å½’cost functionè¿ç®—åæ±‚å’Œ</li>
  <li>åé¢ä¸‰ä¸ªæ±‚å’Œç¬¦å·æ˜¯æ˜¯æ¯å±‚ç¥ç»ç½‘ç»œèŠ‚ç‚¹çš„Î¸çŸ©é˜µå¹³æ–¹å’Œçš„ç´¯åŠ æ±‚å’Œ</li>
  <li>ç‰¹æ®Šæ³¨æ„çš„æ˜¯ï¼Œåé¢ä¸‰ä¸ªæ±‚å’Œç¬¦å·ä¸­ç¬¬ä¸€ä¸ªæ±‚å’Œç¬¦å·ä¸­çš„iä»£è¡¨å±‚æ•°çš„indexï¼Œä¸ä»£è¡¨è®­ç»ƒæ ·æœ¬çš„index</li>
</ol>

<ul>
  <li>Octave demo</li>
</ul>

<p>å‡è®¾æœ‰ä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œå·²çŸ¥æƒé‡çŸ©é˜µTheta1ï¼ŒTheta2ï¼Œä»£ä»·å‡½æ•°ä½¿ç”¨ä»£æ•°å½¢å¼æè¿°ä¸ºï¼š</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">function</span> <span class="p">[</span><span class="n">J</span> <span class="n">grad</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnCostFunction</span><span class="p">(</span><span class="n">num_labels</span><span class="p">,</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Theta1</span><span class="p">,</span> <span class="n">Theta2</span><span class="p">,</span> <span class="n">lambda</span><span class="p">)</span>

<span class="c1">% X:5000x400</span>
<span class="c1">% y:5000x1</span>
<span class="c1">% num_labels:10</span>
<span class="c1">% Theta1: 25x401</span>
<span class="c1">% Theta2: 10x26</span>

<span class="c1">% Setup some useful variables</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


<span class="c1">% make Y: 5000x10</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">eye</span><span class="p">(</span><span class="n">num_labels</span><span class="p">);</span>
<span class="n">Y</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">num_labels</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span>
  <span class="n">Y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span><span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">:);</span>
<span class="k">end</span>

<span class="c1">% cost function</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span><span class="o">.*</span><span class="nb">log</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Y</span><span class="p">)</span><span class="o">.*</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">h</span><span class="p">),</span> <span class="mi">2</span><span class="p">));</span>
<span class="c1">% regularization item</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda</span><span class="p">/(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Theta1</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">Theta2</span><span class="p">(:,</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)));</span>

<span class="c1">% add r</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">J</span><span class="o">+</span><span class="n">r</span><span class="p">;</span>

<span class="k">end</span>
</code></pre></div></div>

<h2 id="backpropagation-algotrithm">Backpropagation algotrithm</h2>

<p>â€œBackpropagationâ€æ˜¯ç¥ç»ç½‘ç»œç”¨æ¥æ±‚è§£<strong>Cost Function</strong>æœ€å°å€¼çš„ç®—æ³•ï¼Œç±»ä¼¼ä¹‹å‰çº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™æ³•ã€‚ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»äº†è§£äº†<strong>Cost Function</strong>çš„å®šä¹‰ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ±‚è§£ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <munder>
    <mo movablelimits="true">min</mo>
    <mi mathvariant="normal">Î˜</mi>
  </munder>
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi mathvariant="normal">Î˜</mi>
  <mo stretchy="false">)</mo>
</math>

<p>å³æ‰¾åˆ°åˆé€‚çš„Î¸å€¼ä½¿<strong>Cost Function</strong>çš„å€¼æœ€å°ï¼Œå³é€šè¿‡ä¸€ä¸ªåˆé€‚çš„ç®—æ³•æ¥æ±‚è§£å¯¹Î¸çš„åå¯¼</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mstyle displaystyle="true">
    <mfrac>
      <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
      <mrow>
        <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
        <msubsup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>,</mo>
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>l</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
      </mrow>
    </mfrac>
  </mstyle>
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
  <mo stretchy="false">)</mo>
</math>

<p>æˆ‘ä»¬å…ˆå‡è®¾ç¥ç»ç½‘ç»œåªæœ‰ä¸€ä¸ªè®­ç»ƒæ ·æœ¬(x,y)ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong>â€œForward Propagationâ€</strong>çš„å‘é‡åŒ–æ–¹å¼æ¥é€å±‚è®¡ç®—æ±‚è§£å‡ºæœ€åçš„ç»“æœ</p>

<p><img src="/assets/images/2017/09/ml-6-13.png" alt="" /></p>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ±‚Î¸çŸ©é˜µçš„å€¼ï¼Œç”¨åˆ°çš„ç®—æ³•å«åš<strong>â€œBackpropagationâ€</strong>ï¼Œæˆ‘ä»¬å®šä¹‰ï¼š</p>

<math display="block"><msubsup><mi>Î´</mi><mi>j</mi><mi>(l)</mi></msubsup><mo>=</mo><mtext>"error" of node j in layer l </mtext></math>

<p>å‡è®¾ <strong>Layer L=4</strong> é‚£ä¹ˆæœ‰ï¼š</p>

<math display="block"><msubsup><mi>Î´</mi><mi>j</mi><mi>(4)</mi></msubsup><mo>=</mo><msubsup><mi>a</mi><mi>j</mi><mi>(4)</mi></msubsup><mo>-</mo><msub><mi>y</mi><mi>j</mi></msub></math>

<p>å‘é‡åŒ–è¡¨ç¤ºä¸ºï¼š</p>

<math display="block"><msup><mi>Î´</mi><mi>(4)</mi></msup><mo>=</mo><msup><mi>a</mi><mi>(4)</mi></msup><mo>-</mo><mi>y</mi></math>

<p>å…¶ä¸­ï¼ŒÎ´ï¼Œaï¼Œyå‘é‡è¡Œæ•°ç­‰äºæœ€åä¸€å±‚èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œè¿™æ ·æˆ‘ä»¬é¦–å…ˆå¾—åˆ°äº†æœ€åä¸€å±‚çš„Î´å€¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦æ ¹æ®æœ€åä¸€å±‚çš„Î´å€¼æ¥å‘å‰è®¡ç®—å‰é¢å„å±‚çš„Î´å€¼ï¼Œç¬¬ä¸‰å±‚çš„å…¬å¼å¦‚ä¸‹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi>Î´</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <mo stretchy="false">(</mo>
  <mo stretchy="false">(</mo>
  <msup>
    <mi mathvariant="normal">Î˜</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <msup>
    <mo stretchy="false">)</mo>
    <mi>T</mi>
  </msup>
  <msup>
    <mi>Î´</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>4</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
  <mo>âˆ—</mo>
  <mtext>&#xA0;</mtext>
 <msup>
    <mi>g</mi>
    <mo>'</mo>
  </msup>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
 </math>

<p>ç¬¬äºŒå±‚çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi>Î´</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo>=</mo>
  <mo stretchy="false">(</mo>
  <mo stretchy="false">(</mo>
  <msup>
    <mi mathvariant="normal">Î˜</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <msup>
    <mo stretchy="false">)</mo>
    <mi>T</mi>
  </msup>
  <msup>
    <mi>Î´</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>3</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
  <mo>âˆ—</mo>
  <mtext>&#xA0;</mtext>
 <msup>
    <mi>g</mi>
    <mo>'</mo>
  </msup>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mn>2</mn>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
 </math>

<p><br />&lt;/br&gt;
 ç¬¬ä¸€å±‚æ˜¯è¾“å…¥å±‚ï¼Œæ˜¯æ ·æœ¬æ•°æ®ï¼Œæ²¡æœ‰é”™è¯¯ï¼Œå› æ­¤ä¸å­˜åœ¨<math><msup><mi>Î´</mi><mi>(1)</mi></msup></math>
<br />&lt;/br&gt;</p>

<p>åœ¨ä¸Šè¿°çš„å¼å­ä¸­ï¼Œ<math><msup><mi>g</mi><mo>'</mo></msup></math>å¯¹<math xmlns="http://www.w3.org/1998/Math/MathML"> <msup> <mi>z</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msup> </math>çš„æ±‚å¯¼ç­‰ä»·äºä¸‹é¢å¼å­ï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <msup>
    <mi>g</mi>
    <mo>'</mo>
  </msup>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>z</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>l</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <msup>
    <mi>a</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>l</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
  <mo> âˆ— </mo>
  <mtext>&#xA0;</mtext>
  <mo stretchy="false">(</mo>
  <mn>1</mn>
  <mo>-</mo>
  <msup>
    <mi>a</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>l</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
</math>

<p>å› æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€è°“çš„<strong>Backpropagation Algorithm</strong>å³æ˜¯å…ˆè®¡ç®—æœ€åä¸€å±‚çš„Î´å€¼ï¼Œç„¶åä¾æ¬¡å‘å‰è®¡ç®—å„å±‚çš„Î´å€¼ã€‚</p>

<p>å¦‚æœå¿½ç•¥regularizationé¡¹ï¼Œå³<math><mi>Î»</mi><mo>=</mo><mn>0</mn></math>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°å¦‚ä¸‹å¼å­:</p>

<math display="block"><mstyle displaystyle="true"><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msubsup><mi>Î˜</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mi>J</mi><mo stretchy="false">(</mo><mi>Î˜</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>a</mi><mi>j</mi><mi>(l)</mi></msubsup><msubsup><mi>Î´</mi><mi>i</mi><mi>(l+1)</mi></msubsup></math>

<p>ä¸Šé¢æ˜¯<strong>Layer L=4</strong>çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬å¯¹Backpropagation Algorithmå…ˆæœ‰äº†ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ï¼Œæ¥ä¸‹æ¥ä»é€šç”¨çš„è§’åº¦ç»™å‡ºBackpropagation Algorithmçš„è®¡ç®—æ­¥éª¤</p>

<p>å‡è®¾æœ‰è®­ç»ƒé›† <math><mo fence="false" stretchy="false">{</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>â‹¯</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></msup><mo>,</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo fence="false" stretchy="false">}</mo></math>ï¼Œä»¤</p>

<ul>
  <li>
    <p>å¯¹æ‰€æœ‰<math><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>l</mi></math> ï¼Œä»¤ <math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal">Î”</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></math> = 0ï¼Œå¾—åˆ°ä¸€ä¸ªå…¨é›¶çŸ©é˜µ</p>
  </li>
  <li>
    <p>For i=1 to m åšå¾ªç¯ï¼Œæ¯ä¸ªå¾ªç¯ä½“æ‰§è¡Œä¸‹é¢æ“ä½œ</p>

    <ol>
      <li>
        <math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>:=</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></math>
        <p>è®©ç¥ç»ç½‘ç»œç¬¬ä¸€å±‚ç­‰äºè¾“å…¥çš„è®­ç»ƒæ•°æ®</p>
      </li>
      <li>
        <p>å¯¹ <math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup></math> è¿›è¡Œ<strong>â€œForward Propagationâ€</strong>è®¡ç®—ï¼Œå…¶ä¸­ <code class="highlighter-rouge">l=2,3,â€¦,L</code> è®¡ç®—è¿‡ç¨‹å¦‚ä¸Šæ–‡å›¾ç¤º</p>
      </li>
      <li>
        <p>ä½¿ç”¨ <math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></math>æ¥è®¡ç®— <math><msup><mi>Î´</mi><mi>(L)</mi></msup><mo>=</mo><msup><mi>a</mi><mi>(L)</mi></msup><mo>-</mo><msup><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup></math></p>
      </li>
      <li>
        <p>æ ¹æ® <math><msup><mi>Î´</mi><mi>(L)</mi></msup></math> å‘å‰è®¡ç®— <math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Î´</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>L</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>,</mo><msup><mi>Î´</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>L</mi><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>,</mo><mo>â€¦</mo><mo>,</mo><msup><mi>Î´</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></math>ï¼Œå…¬å¼ä¸ºï¼š<math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>&#x03B4;<!--Î´--></mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msup><mi mathvariant="normal">&#x0398;<!--Î˜--></mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msup><mi>&#x03B4;<!--Î´--></mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mtext>&#xA0;</mtext><mo>.</mo><mo>&#x2217;<!--âˆ—--></mo><mtext>&#xA0;</mtext><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mtext>&#xA0;</mtext><mo>.</mo><mo>&#x2217;<!--âˆ—--></mo><mtext>&#xA0;</mtext><mo stretchy="false">(</mo><mn>1</mn><mo>&#x2212;<!--âˆ’--></mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></math> è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°äº†é“¾å¼æ³•åˆ™ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¼šä»‹ç»</p>
      </li>
      <li>
        <math xmlns="http://www.w3.org/1998/Math/MathML"> <msubsup> <mi mathvariant="normal">&#x0394;<!-- Î” --></mi> <mrow class="MJX-TeXAtom-ORD"> <mi>i</mi> <mo>,</mo> <mi>j</mi> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msubsup> <mo>:=</mo> <msubsup> <mi mathvariant="normal">&#x0394;<!-- Î” --></mi> <mrow class="MJX-TeXAtom-ORD"> <mi>i</mi> <mo>,</mo> <mi>j</mi> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msubsup> <mo>+</mo> <msubsup> <mi>a</mi> <mi>j</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msubsup> <msubsup> <mi>&#x03B4;<!-- Î´ --></mi> <mi>i</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo>+</mo> <mn>1</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </math>
        <p>å¯¹æ¯å±‚çš„Î¸çŸ©é˜µåå¯¼ä¸æ–­å åŠ ï¼Œè¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼Œå‰é¢çš„å¼å­ä¹Ÿå¯ä»¥ç”¨å‘é‡åŒ–è¡¨ç¤º <math xmlns="http://www.w3.org/1998/Math/MathML"> <msup> <mi mathvariant="normal">&#x0394;<!-- Î” --></mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo>:=</mo> <msup> <mi mathvariant="normal">&#x0394;<!-- Î” --></mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo>+</mo> <msup> <mi>&#x03B4;<!-- Î´ --></mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo>+</mo> <mn>1</mn> <mo stretchy="false">)</mo> </mrow> </msup> <mo stretchy="false">(</mo> <msup> <mi>a</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msup> <msup> <mo stretchy="false">)</mo> <mi>T</mi> </msup> </math></p>
      </li>
    </ol>
  </li>
  <li>
    <p>åŠ ä¸ŠRegularizationé¡¹å¾—åˆ°æœ€ç»ˆçš„Î¸çŸ©é˜µ</p>
    <ul>
      <li>å½“ jâ‰ 0 æ—¶ï¼Œ$ D_{i,j}^{(l)} \thinspace := \thinspace \frac{1}{m}(\Delta_{i,j}^{(l)} + \lambda \Theta_{i,j}^{(l)}), \thinspace if \thinspace $</li>
      <li>å½“ j=0 æ—¶ï¼Œ$ D_{i,j}^{(l)} \thinspace := \thinspace \frac{1}{m}\Delta_{i,j}^{(l)} $</li>
    </ul>
  </li>
</ul>

<p>å¤§å†™çš„DçŸ©é˜µç”¨æ¥è¡¨ç¤ºÎ¸çŸ©é˜µçš„è®¡ç®—æ˜¯ä¸æ–­å åŠ çš„ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„åå¯¼å¼å­ä¸ºï¼š</p>

<script type="math/tex; mode=display">\frac{\partial{J(\Theta)}}{\partial\Theta_{ij}^{(l)}} \thinspace = \thinspace D_{(ij)}^{(l)}</script>

<h3 id="backpropagation-intuition">Backpropagation Intuition</h3>

<p>è¿™ä¸€å°èŠ‚å¯¹ä¸Šé¢æåˆ°çš„Backpropagation(åé¢ç®€ç§°BPç®—æ³•)åšä¸€ä¸ªç®€å•çš„æ•°å­¦æ¨åˆ°ï¼Œæ¥ææ¸…æ¥š<math> <msubsup> <mi>Î´ </mi> <mi>j</mi> <mrow> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msubsup> </math>çš„è®¡ç®—è¿‡ç¨‹ã€‚</p>

<p>è¿˜æ˜¯å…ˆçœ‹Forward Propagationï¼Œæˆ‘ä»¬è¿˜æ˜¯æ‹¿å‰é¢çš„å›¾è·ç¦»ï¼Œå‡è®¾ç¥ç»ç½‘ç»œå¦‚ä¸‹å›¾</p>

<p><img src="/assets/images/2017/09/ml-6-5.png" alt="" /></p>

<p>ä»–åªæœ‰ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼Œç”±ä¹‹å‰æåˆ°çš„Forward Propagationå¾—åˆ°çš„é¢„æµ‹å‡½æ•°ä¸ºï¼š</p>

<math display="block">
<msub>
  <mi>h</mi>
	<mi mathvariant="normal">Î˜</mi>
</msub>
<mo stretchy="false">(</mo>
<mi>x</mi>
<mo stretchy="false">)</mo>
<mo>=</mo>
<msubsup>
  <mi>a</mi>
  <mn>1</mn>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>3</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<mo>=</mo>
<mi>g</mi>
<mo stretchy="false">(</mo>
<msubsup>
  <mi mathvariant="normal">Î˜</mi>
  <mrow class="MJX-TeXAtom-ORD">
    <mn>10</mn>
  </mrow>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<msubsup>
  <mi>a</mi>
  <mn>0</mn>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<mo>+</mo>
<msubsup>
  <mi mathvariant="normal">Î˜</mi>
  <mrow class="MJX-TeXAtom-ORD">
    <mn>11</mn>
  </mrow>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<msubsup>
  <mi>a</mi>
  <mn>1</mn>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<mo>+</mo>
<msubsup>
  <mi mathvariant="normal">Î˜</mi>
  <mrow class="MJX-TeXAtom-ORD">
    <mn>12</mn>
  </mrow>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<msubsup>
  <mi>a</mi>
  <mn>2</mn>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<mo>+</mo>
<msubsup>
  <mi mathvariant="normal">Î˜</mi>
  <mrow class="MJX-TeXAtom-ORD">
    <mn>13</mn>
  </mrow>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<msubsup>
  <mi>a</mi>
  <mn>3</mn>
  <mrow class="MJX-TeXAtom-ORD">
    <mo stretchy="false">(</mo>
    <mn>2</mn>
    <mo stretchy="false">)</mo>
  </mrow>
</msubsup>
<mo stretchy="false">)</mo>
</math>

<p>è¿™ä¸ªå‡½æ•°ä¸­ï¼š</p>

<ol>
  <li>
    <math> <msub> <mi>h</mi> <mi mathvariant="normal">Î˜</mi> </msub> <mo stretchy="false">(</mo> <mi>x</mi> <mo stretchy="false">)</mo> </math>
    <p>æ˜¯ä»¥Î˜ä¸ºå˜é‡çš„å‡½æ•°</p>
  </li>
  <li>å®ƒçš„è®¡ç®—è¿‡ç¨‹æ˜¯ä»ç¬¬ä¸€å±‚å¼€å§‹å‘æœ€åä¸€å±‚é€å±‚è®¡ç®—ï¼Œæ¯ä¸€å±‚æ¯ä¸ªèŠ‚ç‚¹çš„å€¼æ˜¯ç”±å®ƒåä¸€å±‚çš„èŠ‚ç‚¹ä¹˜ä»¥æƒé‡çŸ©é˜µÎ˜</li>
</ol>

<p>BPçš„è®¡ç®—å’Œæ¨å¯¼ä¸å¦‚Forwardå®¹æ˜“ç†è§£ï¼Œä¹Ÿä¸ç›´è§‚ï¼Œå®ƒçš„ç‰¹ç‚¹ç±»å’ŒFBç±»ä¼¼</p>

<ol>
  <li>Î´ä¹Ÿæ˜¯è‡ªå˜é‡ä¸ºÎ¸çš„å‡½æ•°</li>
  <li>å®ƒçš„è®¡ç®—è¿‡ç¨‹æ˜¯ä»æœ€åä¸€å±‚å¼€å§‹å‘ç¬¬ä¸€å±‚é€å±‚è®¡ç®—ï¼Œæ¯å±‚çš„Î´å€¼æ˜¯ç”±å®ƒå‰é¢ä¸€å±‚çš„Î´å€¼ä¹˜ä»¥æƒé‡çŸ©é˜µÎ¸</li>
  <li>å®ƒçš„è®¡ç®—åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æ±‚æ¢¯åº¦ï¼ˆå¯¹Î¸æ±‚åå¯¼ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æ¢¯åº¦ä¸‹é™</li>
</ol>

<p>å…ˆè¯´ç¬¬ä¸€éƒ¨åˆ†æ±‚æ¢¯åº¦ï¼Œç”±ä¸ŠèŠ‚ç»™å‡ºçš„ä»£ä»·å‡½æ•°ä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mtable rowspacing="3pt" columnspacing="1em" displaystyle="true" minlabelspacing=".8em">
    <mtr>
      <mtd>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mfrac>
          <mn>1</mn>
          <mi>m</mi>
        </mfrac>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>m</mi>
        </munderover>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>K</mi>
        </munderover>
        <mfenced open="[" close="]">
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mi>k</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msubsup>
            <mtext>&#xA0;</mtext>
            <mi>log</mi>
            <mo>&#x2061;<!-- â¡ --></mo>
            <mo stretchy="false">(</mo>
            <msub>
              <mi>h</mi>
              <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
            </msub>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>x</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msup>
            <mo stretchy="false">)</mo>
            <msub>
              <mo stretchy="false">)</mo>
              <mi>k</mi>
            </msub>
            <mo>+</mo>
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <msubsup>
              <mi>y</mi>
              <mi>k</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msubsup>
            <mo stretchy="false">)</mo>
            <mtext>&#xA0;</mtext>
            <mi>log</mi>
            <mo>&#x2061;<!-- â¡ --></mo>
            <mo stretchy="false">(</mo>
            <mn>1</mn>
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <msub>
              <mi>h</mi>
              <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
            </msub>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>x</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo stretchy="false">(</mo>
                <mi>i</mi>
                <mo stretchy="false">)</mo>
              </mrow>
            </msup>
            <msub>
              <mo stretchy="false">)</mo>
              <mi>k</mi>
            </msub>
            <mo stretchy="false">)</mo>
          </mrow>
        </mfenced>
        <mo>+</mo>
        <mfrac>
          <mi>&#x03BB;<!-- Î» --></mi>
          <mrow>
            <mn>2</mn>
            <mi>m</mi>
          </mrow>
        </mfrac>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>l</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>L</mi>
            <mo>&#x2212;<!-- âˆ’ --></mo>
            <mn>1</mn>
          </mrow>
        </munderover>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>s</mi>
              <mi>l</mi>
            </msub>
          </mrow>
        </munderover>
        <munderover>
          <mo>&#x2211;<!-- âˆ‘ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>s</mi>
              <mi>l</mi>
            </msub>
            <mo>+</mo>
            <mn>1</mn>
          </mrow>
        </munderover>
        <mo stretchy="false">(</mo>
        <msubsup>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
            <mo>,</mo>
            <mi>i</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo stretchy="false">(</mo>
            <mi>l</mi>
            <mo stretchy="false">)</mo>
          </mrow>
        </msubsup>
        <msup>
          <mo stretchy="false">)</mo>
          <mn>2</mn>
        </msup>
      </mtd>
    </mtr>
  </mtable>
</math>

<p>å¦‚æœå°†regularizationé¡¹å¿½ç•¥ï¼Œä»¤K=1,å¯¹äºå•ä¸€èŠ‚ç‚¹<math><msup><mi>x</mi><mi>(i)</mi></msup></math>,<math><msup><mi>y</mi><mi>(i)</mi></msup></math>çš„ä»£ä»·å‡½æ•°ç®€åŒ–ä¸ºï¼š</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
	<mi>J</mi>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
    <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mo>-</mo>
  <msup>
    <mi>y</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mtext>&#xA0;</mtext>
  <mi>log</mi>
  <mo>&#x2061;<!-- â¡ --></mo>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>h</mi>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo stretchy="false">)</mo>
  <mo>+</mo>
  <mo stretchy="false">(</mo>
  <mn>1</mn>
  <mo>&#x2212;<!-- âˆ’ --></mo>
  <msup>
    <mi>y</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mtext>&#xA0;</mtext>
  <mi>log</mi>
  <mo>&#x2061;<!-- â¡ --></mo>
  <mo stretchy="false">(</mo>
  <mn>1</mn>
  <mo>âˆ’</mo>
  <msub>
    <mi>h</mi>
    <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
  <mo stretchy="false">)</mo>
</math>

<p>ä¸Šé¢å‡½æ•°è¿‘ä¼¼çº¦ç­‰äº:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
	<mi>J</mi>
    <mo stretchy="false">(</mo>
    <mi mathvariant="normal">Î˜</mi>
    <mo stretchy="false">)</mo>
  <mo>â‰ˆ</mo>
  <mo>(</mo>
  <msub>
    <mi>h</mi>
    <mi mathvariant="normal">Î˜</mi>
  </msub>
  <mo stretchy="false">(</mo>
  <msup>
    <mi>x</mi>
    <mrow class="MJX-TeXAtom-ORD">
      <mo stretchy="false">(</mo>
      <mi>i</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </msup>
  <mo stretchy="false">)</mo>
	  <mo>-</mo>
	<msup>
	<mi>y</mi>
	<mrow class="MJX-TeXAtom-ORD">
	  <mo stretchy="false">(</mo>
	  <mi>i</mi>
	  <mo stretchy="false">)</mo>
	</mrow>
	</msup>
	<msup>
	<mo>)</mo>
	<mn>2</mn>
	</msup>
</math>

<p>å…¶ä¸­<code class="highlighter-rouge">l</code>ä»£è¡¨ç¥ç»ç½‘ç»œlayerçš„indexï¼Œå›å¿†è¿™ä¸ªå‡½æ•°çš„å«ä¹‰æ˜¯è®¡ç®—æ ·æœ¬ <math xmlns="http://www.w3.org/1998/Math/MathML"> <mo stretchy="false">(</mo> <msup> <mi>x</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>i</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo>,</mo> <msup> <mi>y</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>i</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo stretchy="false">)</mo> </math> å’Œé¢„æµ‹ç»“æœçš„è¯¯å·®å€¼ï¼Œæ¥ä¸‹æ¥çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°ä½¿è¿™ä¸ªå‡½æ•°çš„è¾¾åˆ°æœ€å°å€¼çš„Î˜ï¼Œæ‰¾åˆ°çš„åŠæ³•æ˜¯é€šè¿‡æ¢¯åº¦ä¸‹é™çš„æ–¹å¼ï¼Œä½¿<math><mi>J(Î˜)</mi></math>æ²¿æ¢¯åº¦ä¸‹é™æœ€å¿«çš„æ–¹å‘è¾¾åˆ°æå€¼ï¼ˆæ³¨æ„ï¼š<math><mi>J(Î˜)</mi></math>ä¸æ˜¯convexå‡½æ•°ï¼Œä¸ä¸€å®šæœ‰æœ€å°å€¼ï¼Œå¾ˆå¯èƒ½æ”¶æ•›åˆ°äº†æå€¼ç‚¹ï¼‰ï¼Œæ¢¯åº¦ä¸‹é™éœ€è¦ç”¨åˆ° <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi mathvariant="normal">âˆ‚</mi> <mi>J(Î˜)</mi><mrow class="MJX-TeXAtom-ORD"> <mo>/</mo> </mrow> <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi> <msubsup> <mi>Î˜</mi> <mrow class="MJX-TeXAtom-ORD"> <mi>j</mi> <mi>i</mi> </mrow> <mi>(l)</mi> </msubsup> </math> ï¼Œå¹¶å°†è®¡ç®—ç»“æœä¿å­˜åˆ°<math xmlns="http://www.w3.org/1998/Math/MathML"> <msup> <mi mathvariant="normal">&#x0394;<!-- Î” --></mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msup> </math> ä¸­ã€‚</p>

<p>ä¸‹é¢æˆ‘ä»¬ä»¥3å±‚ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œåˆ†è§£è¿™ä¸ªæ¨å¯¼è¿‡ç¨‹ï¼Œç¥ç»ç½‘ç»œå¦‚ä¸‹å›¾æ‰€ç¤º</p>

<p><img src="/assets/images/2017/09/ml-6-14.png" alt="" /></p>

<p>å†æ¥å›é¡¾ä¸€ä¸‹å„ä¸ªå˜é‡çš„å«ä¹‰ä¸ºï¼š</p>

<ul>
  <li>å¦ <math><msub><mi>x</mi><mn>1</mn></msub></math>å’Œ<math><msub><mi>x</mi><mn>2</mn></msub></math> è¡¨ç¤ºç¥ç»ç½‘ç»œçš„è¾“å…¥æ ·æœ¬ï¼Œä¸¤ä¸ªç‰¹å¾</li>
  <li>å¦ <math><msubsup><mi>z</mi><mi>j</mi><mi>(l)</mi></msubsup></math>è¡¨ç¤ºç¬¬lå±‚çš„ç¬¬<code class="highlighter-rouge">j</code>ä¸ªèŠ‚ç‚¹çš„è¾“å…¥å€¼</li>
  <li>å¦ <math><msubsup><mi>a</mi><mi>j</mi><mi>(l)</mi></msubsup></math>è¡¨ç¤ºç¬¬lå±‚çš„ç¬¬<code class="highlighter-rouge">j</code>ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºå€¼</li>
  <li>å¦ <math><msubsup><mi>Î˜</mi><mrow><mi>j</mi><mi>i</mi></mrow><mi>(l)</mi></msubsup></math>è¡¨ç¤ºç¬¬<code class="highlighter-rouge">l</code>å±‚åˆ°ç¬¬<code class="highlighter-rouge">l+1</code>å±‚çš„æƒé‡çŸ©é˜µ</li>
  <li>å¦ <math> <msubsup> <mi>Î´ </mi> <mi>j</mi> <mrow> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msubsup> </math>è¡¨ç¤ºç¬¬<code class="highlighter-rouge">l</code>å±‚ç¬¬<code class="highlighter-rouge">j</code>ä¸ªèŠ‚ç‚¹çš„é¢„æµ‹åå·®å€¼ï¼Œä»–çš„æ•°å­¦å®šä¹‰ä¸º<math><msubsup> <mi>Î´</mi><mi>j</mi><mi>(l)</mi></msubsup> <mo>=</mo> <mfrac> <mi mathvariant="normal">âˆ‚</mi> <mrow> <mi mathvariant="normal"> âˆ‚</mi> <msubsup> <mi>z</mi> <mi>j</mi><mi>(l)</mi> </msubsup> </mrow> </mfrac> <mi>J</mi> <mo stretchy="false">(</mo> <mi mathvariant="normal">Î˜</mi><mo stretchy="false">)</mo></math></li>
</ul>

<p>æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚è§£Î˜çŸ©é˜µçš„å€¼ï¼Œä»¥å¾—å‡ºæœ€ç»ˆçš„é¢„æµ‹å‡½æ•°ï¼Œè¿™ä¸ªä¾‹å­ä¸­ä»¥æ±‚è§£<math><msubsup><mi>Î˜</mi><mn>11</mn><mi>(3)</mi></msubsup></math>å’Œ<math><msubsup><mi>Î˜</mi><mn>11</mn><mi>(2)</mi></msubsup></math>ä¸ºä¾‹</p>

<ol>
  <li>
    <p>å‚è€ƒä¸Šé¢å‡ èŠ‚ï¼Œæˆ‘ä»¬ä»¤<math><msub> <mi>h</mi> <mi> Î˜</mi> </msub> <mo stretchy="false">(</mo> <msup> <mi>x</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>t</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo stretchy="false">)</mo> <mo>=</mo> <mi>g</mi> <mo stretchy="false">(</mo> <msup> <mi>z</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>t</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mi>(t)</mi></msup></math>ï¼Œå…¶ä¸­<math><mi>g</mi></math>ä¸ºsigmoidå‡½æ•°<math><mi>g</mi><mi>(z)</mi><mo>=</mo><mstyle><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>âˆ’</mo><mi>z</mi></mrow></msup></mrow></mfrac></mstyle></math></p>
  </li>
  <li>
    <p>å…ˆæ±‚ <math><msubsup><mi>Î˜</mi><mrow><mi>1</mi><mi>1</mi></mrow><mi>(3)</mi></msubsup></math>ï¼Œç”±é“¾å¼è§„åˆ™ï¼Œå¯ä»¥åšå¦‚ä¸‹è¿ç®—ï¼š<math> <mfrac> <mrow> <mi>âˆ‚</mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi>Î˜</mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal">âˆ‚ </mi> <msubsup> <mi>Î˜</mi> <mrow> <mn>11</mn> </mrow> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo>=</mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi mathvariant="normal"> Î˜ </mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mi>(4)</mi> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi mathvariant="normal"> Î˜ </mi> <mrow class="MJX-TeXAtom-ORD"> <mn>11</mn> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac></math></p>
  </li>
  <li>
    <p>å‚è€ƒä¸Šé¢Î´çš„å®šä¹‰ï¼Œå¯çŸ¥ä¸Šé¢ç­‰å¼åä¸¤é¡¹ä¸ºï¼š<math><msubsup><mi>Î´</mi><mn>1</mn><mi>(4)</mi></msubsup><mo>=</mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi mathvariant="normal"> Î˜ </mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mi>(4)</mi> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac></math>ï¼Œ å³è¾“å‡ºå±‚ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„è¯¯å·®å€¼ï¼Œå±•å¼€è®¡ç®—å¦‚ä¸‹ï¼š</p>

    <math display="block"><msubsup><mi>Î´</mi><mn>1</mn><mi>(4)</mi></msubsup><mo>=</mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi mathvariant="normal"> Î˜ </mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mi>(4)</mi> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac><mo>=</mo><mo>&#x2212;<!-- âˆ’ --></mo> <mo stretchy="false">[</mo> <mi>y</mi> <mo>&#x2217;<!-- âˆ— --></mo> <mo stretchy="false">(</mo> <mn>1</mn> <mo>&#x2212;<!-- âˆ’ --></mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo stretchy="false">)</mo> <mo>+</mo> <mo stretchy="false">(</mo> <mi>y</mi> <mo>&#x2212;<!-- âˆ’ --></mo> <mn>1</mn> <mo stretchy="false">)</mo> <mo>&#x2217;<!-- âˆ— --></mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo stretchy="false">]</mo><mo>=</mo> <mo>&#x2212;<!-- âˆ’ --></mo> <mo stretchy="false">[</mo> <mi>y</mi> <mo>&#x2217;<!-- âˆ— --></mo> <mo stretchy="false">(</mo> <mn>1</mn> <mo>&#x2212;<!-- âˆ’ --></mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo stretchy="false">)</mo> <mo>+</mo> <mo stretchy="false">(</mo> <mi>y</mi> <mo>&#x2212;<!-- âˆ’ --></mo> <mn>1</mn> <mo stretchy="false">)</mo> <mo>&#x2217;<!-- âˆ— --></mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo stretchy="false">]</mo> <mo>=</mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo>&#x2212;<!-- âˆ’ --></mo> <mi>y</mi> <mo>=</mo> <msup> <mi>a</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msup> <mo>&#x2212;<!-- âˆ’ --></mo> <mi>y</mi></math>
    <p>ï¼Œå…¶ä¸­ç”¨åˆ°äº†sigmoidå‡½æ•°ä¸€ä¸ªç‰¹æ€§ï¼š<math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>g</mi> <mi class="MJX-variant" mathvariant="normal">&#x2032;<!-- â€² --></mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo>=</mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo>&#x2217;<!-- âˆ— --></mo> <mo stretchy="false">(</mo> <mn>1</mn> <mo>&#x2212;<!-- âˆ’ --></mo> <mi>g</mi> <mo stretchy="false">(</mo> <mi>z</mi> <mo stretchy="false">)</mo> <mo stretchy="false">)</mo></math></p>
  </li>
  <li>
    <p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†<math><msubsup><mi>Î´</mi><mn>1</mn><mi>(4)</mi></msubsup></math>ï¼ˆå‚è€ƒä¸Šä¸€èŠ‚BPç®—æ³•çš„æ­¥éª¤(3)ï¼‰ï¼Œæ¥ä¸‹æ¥ç»§ç»­æ±‚è§£<math><mfrac><mrow> <mi>âˆ‚</mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi>Î˜</mi> <mo stretchy="false">)</mo> </mrow><mrow> <mi>âˆ‚ </mi> <msubsup> <mi mathvariant="normal">Î˜</mi> <mrow> <mn>11</mn> </mrow> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow></mfrac></math>ï¼Œå‰é¢ç¬¬äºŒæ­¥ç­‰å·åçš„æœ€æœ‰ä¸€é¡¹<math><mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi mathvariant="normal"> Î˜ </mi> <mrow class="MJX-TeXAtom-ORD"> <mn>11</mn> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac></math>ï¼Œå°†<math><msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo></mrow></msubsup></math>å±•å¼€æœ‰ï¼š<math><msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><msubsup><mi>Î˜</mi><mrow><mi>1</mi><mi>0</mi></mrow><mi>(3)</mi></msubsup><mo> * </mo><msubsup><mi>a</mi><mn>0</mn><mi>(3)</mi></msubsup><mo>+</mo><msubsup><mi>Î˜</mi><mrow><mi>1</mi><mi>1</mi></mrow><mi>(3)</mi></msubsup><mo> * </mo><msubsup><mi>a</mi><mn>1</mn><mi>(3)</mi></msubsup><mo>+</mo><msubsup><mi>Î˜</mi><mrow><mi>1</mi><mi>2</mi></mrow><mi>(3)</mi></msubsup><mo> * </mo><msubsup><mi>a</mi><mn>2</mn><mi>(3)</mi></msubsup></math>ï¼Œå¯¹<math><msubsup><mi>Î˜</mi><mrow><mi>1</mi><mi>1</mi></mrow><mi>(3)</mi></msubsup></math>æ±‚åå¯¼çš„ç»“æœä¸º<math><msubsup><mi>a</mi><mn>1</mn><mi>(3)</mi></msubsup></math></p>
  </li>
  <li>
    <p>å°†ç¬¬4æ­¥ä¸ç¬¬ä¸‰æ­¥çš„å¼å­åˆå¹¶ï¼Œå³å¾—å‡º <math><mfrac><mrow> <mi>âˆ‚</mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi>Î˜</mi> <mo stretchy="false">)</mo> </mrow><mrow> <mi>âˆ‚ </mi> <msubsup> <mi mathvariant="normal">Î˜</mi> <mrow> <mn>11</mn> </mrow> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow></mfrac><mo>=</mo><msubsup><mi>Î´</mi><mn>1</mn><mi>(4)</mi></msubsup><mo> * </mo><msubsup><mi>a</mi><mn>1</mn><mi>(3)</mi></msubsup></math> ä¸ä¸Šä¸€èŠ‚BPç®—æ³•æ­¥éª¤(5)ä¸€è‡´</p>
  </li>
  <li>
    <p>æ¥ä¸‹æ¥è®¡ç®—<math><msubsup><mi>Î˜</mi><mrow><mi>1</mi><mi>1</mi></mrow><mi>(2)</mi></msubsup></math>ï¼Œé“¾å¼è§„åˆ™å¯åšå¦‚ä¸‹è¿ç®—<math> <mfrac> <mrow> <mi>âˆ‚</mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi>Î˜</mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal">âˆ‚ </mi> <msubsup> <mi>Î˜</mi> <mrow> <mn>11</mn> </mrow> <mrow> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo>=</mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi mathvariant="normal"> Î˜ </mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mi>(4)</mi> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi> âˆ‚ </mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi>âˆ‚</mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac><mo> * </mo><mfrac> <mrow> <mi> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi>âˆ‚</mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac><mo> * </mo><mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi mathvariant="normal"> Î˜ </mi> <mrow class="MJX-TeXAtom-ORD"> <mn>11</mn> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac></math></p>
  </li>
  <li>
    <p>å‚è€ƒä¸Šé¢Î´çš„å®šä¹‰ï¼Œå¯çŸ¥<math> <msubsup> <mi>Î´ </mi> <mi>1</mi> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> <mo>=</mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi mathvariant="normal"> Î˜ </mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mi>(4)</mi> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo> âˆ— </mo> <mfrac> <mrow> <mi> âˆ‚ </mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi>âˆ‚</mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac><mo> * </mo><mfrac> <mrow> <mi> âˆ‚ </mi> <msubsup> <mi>a</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi>âˆ‚</mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac></math>ï¼Œç”±ä¸Šé¢çš„æ­¥éª¤3å¯çŸ¥ï¼Œç­‰å¼çš„å‰ä¸¤é¡¹ä¸º<math><msubsup> <mi>Î´ </mi> <mi>1</mi> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup></math>ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºå¯¹Î´å€¼çš„è®¡ç®—å’Œä¹‹å‰çš„FBç®—æ³•ç±»ä¼¼ï¼Œå¦‚æœå°†ç¥ç»ç½‘ç»œåå‘æ¥çœ‹ï¼Œå½“å‰å±‚çš„<math><msup> <mi>Î´ </mi> <mi>1</mi></msup></math>å€¼æ˜¯æ ¹æ®åä¸€å±‚çš„<math><msup> <mi>Î´ </mi> <mi>(1-1)</mi></msup></math>è®¡ç®—å¾—æ¥ã€‚ç­‰å¼çš„ç¬¬ä¸‰é¡¹ï¼Œå°†<math><msubsup><mi>z</mi><mn>1</mn><mi>(4)</mi></msubsup></math>å±•å¼€åå¯¹<math><msubsup><mi>a</mi><mn>1</mn><mi>(3)</mi></msubsup></math>æ±‚å¯¼åå¾—åˆ°<math><msubsup><mi>Î˜</mi><mn>11</mn><mi>(3)</mi></msubsup></math>ï¼Œç­‰å¼æœ€åä¸€é¡¹ä¸º<math> <mi>g</mi> <mi class="MJX-variant" mathvariant="normal">&#x2032;<!-- â€² --></mi> <mo stretchy="false">(</mo> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> <mo stretchy="false">)</mo></math></p>
  </li>
  <li>
    <p>å°†ä¸Šä¸€æ­¥çš„ç»“æœè¿›è¡Œæ•´ç†å¾—åˆ°: <math><msubsup> <mi>Î´ </mi> <mi>1</mi> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup><mo>=</mo><msubsup> <mi>Î´ </mi> <mi>1</mi> <mrow> <mo stretchy="false">(</mo> <mn>4</mn> <mo stretchy="false">)</mo> </mrow> </msubsup><mo> * </mo><msubsup><mi>Î˜</mi><mn>11</mn><mi>(3)</mi></msubsup> <mo> * </mo> <mi>g</mi> <mi class="MJX-variant" mathvariant="normal">&#x2032;<!-- â€² --></mi> <mo stretchy="false">(</mo> <msubsup> <mi>z</mi> <mn>1</mn> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> <mo stretchy="false">)</mo></math> å’Œä¸Šä¸€èŠ‚BPç®—æ­¥éª¤(4)ä¸€è‡´</p>
  </li>
  <li>
    <p>å°†8çš„ç»“æœå¸¦å…¥ç¬¬6æ­¥ï¼Œå¯å¾—å‡º<math> <mfrac> <mrow> <mi>âˆ‚</mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi>Î˜</mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal">âˆ‚ </mi> <msubsup> <mi>Î˜</mi> <mrow> <mn>11</mn> </mrow> <mrow> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo>=</mo> <msubsup> <mi>Î´ </mi> <mi>1</mi> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup>  <mo> * </mo><mfrac> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi>z</mi> <mn>1</mn> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> <mrow> <mi mathvariant="normal"> âˆ‚ </mi> <msubsup> <mi mathvariant="normal"> Î˜ </mi> <mrow class="MJX-TeXAtom-ORD"> <mn>11</mn> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac></math>ï¼Œå°†<math><msubsup><mi>z</mi><mn>1</mn><mi>(3)</mi></msubsup></math>å±•å¼€åå¯¹<math><msubsup> <mi mathvariant="normal"> Î˜ </mi> <mrow class="MJX-TeXAtom-ORD"> <mn>11</mn> </mrow> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup></math>æ±‚å¯¼å¾—åˆ°<math><msubsup><mi>a</mi><mn>1</mn><mi>(2)</mi></msubsup></math></p>
  </li>
  <li>
    <p>æ•´ç†ç¬¬9æ­¥ç»“æœå¯çŸ¥ <math> <mfrac> <mrow> <mi>âˆ‚</mi> <mi>J</mi> <mo stretchy="false">(</mo> <mi>Î˜</mi> <mo stretchy="false">)</mo> </mrow> <mrow> <mi mathvariant="normal">âˆ‚ </mi> <msubsup> <mi>Î˜</mi> <mrow> <mn>11</mn> </mrow> <mrow> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup> </mrow> </mfrac> <mo>=</mo> <msubsup> <mi>Î´ </mi> <mi>1</mi> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup>  <mo> * </mo> <msubsup><mi>a</mi><mn>1</mn><mi>(2)</mi></msubsup></math>ï¼Œä¸ä¸Šä¸€èŠ‚æ­¥éª¤ï¼ˆ5ï¼‰ä¸€è‡´</p>
  </li>
</ol>

<p>é€šè¿‡ä¸Šé¢çš„æ¨å¯¼ï¼Œå¤§æ¦‚å¯ä»¥å°è¯ä¸Šä¸€èŠ‚çš„ç»“è®ºï¼š</p>

<math display="block"><mstyle displaystyle="true"><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msubsup><mi>Î˜</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mi>J</mi><mo stretchy="false">(</mo><mi>Î˜</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>a</mi><mi>j</mi><mi>(l)</mi></msubsup><msubsup><mi>Î´</mi><mi>i</mi><mi>(l+1)</mi></msubsup></math>

<p>è€Œå…³äºå¯¹<math> <msubsup> <mi>Î´ </mi> <mi>j</mi> <mrow> <mo stretchy="false">(</mo> <mi>l</mi> <mo stretchy="false">)</mo> </mrow> </msubsup> </math>çš„è®¡ç®—åˆ™æ˜¯BPç®—æ³•çš„æ ¸å¿ƒï¼Œç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œè®¡ç®—<math><msubsup> <mi>Î´ </mi> <mi>2</mi> <mrow> <mo stretchy="false">(</mo> <mn>3</mn> <mo stretchy="false">)</mo> </mrow> </msubsup></math>å’Œ<math><msubsup> <mi>Î´ </mi> <mi>2</mi> <mrow> <mo stretchy="false">(</mo> <mn>2</mn> <mo stretchy="false">)</mo> </mrow> </msubsup></math>ï¼š</p>

<p><img src="/assets/images/2017/09/ml-6-15.png" alt="" /></p>

<p>å¯ä»¥è§‚å¯Ÿåˆ° BP ç®—æ³•ä¸¤ä¸ªçªå‡ºç‰¹ç‚¹ï¼š</p>

<ol>
  <li>
    <p>è‡ªè¾“å‡ºå±‚å‘è¾“å…¥å±‚ï¼ˆå³åå‘ä¼ æ’­ï¼‰ï¼Œé€å±‚æ±‚åå¯¼ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­é€æ¸å¾—åˆ°å„ä¸ªå±‚çš„å‚æ•°æ¢¯åº¦ã€‚</p>
  </li>
  <li>
    <p>åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ Î´(l)Î´(l) ä¿å­˜äº†éƒ¨åˆ†ç»“æœï¼Œé¿å…äº†å¤§é‡çš„é‡å¤è¿ç®—ï¼Œå› è€Œè¯¥ç®—æ³•æ€§èƒ½ä¼˜å¼‚ã€‚</p>
  </li>
</ol>

<h3 id="implementation-nodte-unrolling-parameters">Implementation Nodte: Unrolling parameters</h3>

<p>è¿™ä¸€å°èŠ‚ä»‹ç»å¦‚ä½•ä½¿ç”¨Advanced optimizationæ¥è®¡ç®—ç¥ç»ç½‘ç»œï¼Œå¯¹äºä¼˜åŒ–å‡½æ•°ï¼Œå‰é¢æœ‰è®²è¿‡ï¼Œçš„å®šä¹‰å¦‚ä¸‹:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="p">[</span><span class="n">jVal</span><span class="p">,</span> <span class="nb">gradient</span><span class="p">]</span> <span class="o">=</span> <span class="n">costFunction</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="k">...</span>

<span class="n">optTheta</span> <span class="o">=</span> <span class="n">fminunc</span><span class="p">(</span><span class="o">@</span><span class="n">costFunction</span><span class="p">,</span> <span class="n">initialTheta</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

</code></pre></div></div>

<p><code class="highlighter-rouge">fminunc</code>çš„ç¬¬äºŒä¸ªå‚æ•°initialThetaéœ€è¦ä¼ å…¥ä¸€ä¸ªvectorï¼Œè€Œæˆ‘ä»¬ä¹‹å‰æ¨å¯¼çš„ç¥ç»ç½‘ç»œæƒé‡çŸ©é˜µÎ˜æ˜¾ç„¶ä¸æ˜¯ä¸€ç»´çš„å‘é‡ï¼Œå¯¹äºä¸€ä¸ªå››å±‚çš„ç¥ç»ç½‘ç»œæ¥è¯´ï¼š</p>

<ul>
  <li>Î˜çŸ©é˜µï¼š<math><msup><mi>Î˜</mi><mi>(1)</mi></msup></math>ï¼Œ<math><msup><mi>Î˜</mi><mi>(2)</mi></msup></math>ï¼Œ<math><msup><mi>Î˜</mi><mi>(3)</mi></msup></math> - matrices(Theta1, Theta2, Theta3)</li>
  <li>æ¢¯åº¦çŸ©é˜µï¼š<math><msup><mi>D</mi><mi>(1)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(2)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(3)</mi></msup></math> - matrices(D1, D2, D3)</li>
</ul>

<p>å› æ­¤æˆ‘ä»¬éœ€è¦å°†çŸ©é˜µè½¬æ¢ä¸ºå‘é‡ï¼Œåœ¨Octaveä¸­ï¼Œå¯ç”¨å¦‚ä¸‹å‘½ä»¤</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">thetaVector</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Theta1</span><span class="p">(:);</span> <span class="n">Theta2</span><span class="p">(:);</span> <span class="n">Theta3</span><span class="p">(:);</span> <span class="p">]</span>
<span class="n">deltaVector</span> <span class="o">=</span> <span class="p">[</span> <span class="n">D1</span><span class="p">(:);</span> <span class="n">D2</span><span class="p">(:);</span> <span class="n">D3</span><span class="p">(:)</span> <span class="p">]</span>

</code></pre></div></div>
<p>è¿™ç§å†™æ³•ä¼šå°†3ä¸ªÎ˜çŸ©é˜µæ’æˆä¸€ç»´å‘é‡ï¼Œå‡è®¾<math><msup><mi>Î˜</mi><mi>(1)</mi></msup></math>æ˜¯10x11çš„ï¼Œ<math><msup><mi>Î˜</mi><mi>(2)</mi></msup></math>æ˜¯10x11çš„ï¼Œ<math><msup><mi>Î˜</mi><mi>(3)</mi></msup></math>æ˜¯1x11çš„ï¼Œä¹Ÿå¯ä»¥ä»<code class="highlighter-rouge">thetaVector</code>å–å‡ºåŸå§‹çŸ©é˜µ</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Theta1</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">thetaVector</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">110</span><span class="p">),</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">Theta2</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">thetaVector</span><span class="p">(</span><span class="mi">111</span><span class="p">:</span><span class="mi">220</span><span class="p">),</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">Theta3</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">thetaVector</span><span class="p">(</span><span class="mi">221</span><span class="p">:</span><span class="mi">231</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</code></pre></div></div>

<p>æ€»ç»“ä¸€ä¸‹ï¼š</p>

<ul>
  <li>å‰é¢å¾—åˆ°çš„<code class="highlighter-rouge">thetaVector</code>ä»£å…¥åˆ°<code class="highlighter-rouge">fminunc</code>ä¸­ï¼Œæ›¿æ¢<code class="highlighter-rouge">initialTheta</code></li>
  <li>
    <p>åœ¨<code class="highlighter-rouge">costFunction</code>ä¸­ï¼Œè¾“å…¥çš„å‚æ•°æ˜¯<code class="highlighter-rouge">thetaVec</code></p>

    <div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">function</span><span class="p">[</span><span class="n">jVal</span><span class="p">,</span><span class="n">gradientVec</span><span class="p">]</span> <span class="o">=</span> <span class="n">costFunction</span><span class="p">(</span><span class="n">thetaVec</span><span class="p">)</span>
</code></pre></div>    </div>
    <p>åœ¨<code class="highlighter-rouge">costFunction</code>ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code class="highlighter-rouge">reshape</code>å‘½ä»¤ä»<code class="highlighter-rouge">theVec</code>å–å‡º<math><msup><mi>Î˜</mi><mi>(1)</mi></msup></math>ï¼Œ<math><msup><mi>Î˜</mi><mi>(2)</mi></msup></math>ï¼Œ<math><msup><mi>Î˜</mi><mi>(3)</mi></msup></math> ç”¨æ¥è®¡ç®—FBå’ŒBPç®—æ³•ï¼Œå¾—åˆ°<math><msup><mi>D</mi><mi>(1)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(2)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(3)</mi></msup></math> æ¢¯åº¦çŸ©é˜µå’Œ<math><mi>J</mi><mi>(Î˜)</mi></math>ï¼Œç„¶åå†unroll <math><msup><mi>D</mi><mi>(1)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(2)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(3)</mi></msup></math>å¾—åˆ°<code class="highlighter-rouge">gradientVec</code></p>
  </li>
</ul>

<h3 id="gradient-checking">Gradient Checking</h3>

<p>åœ¨è®¡ç®—ç¥ç»ç½‘ç»œçš„æ¢¯åº¦æ—¶ï¼Œè¦ç¡®ä¿æ¢¯åº¦è®¡ç®—æ­£ç¡®ï¼Œæœ€å¥½åœ¨è®¡ç®—è¿‡ç¨‹ä¸­è¿›è¡ŒGradient Checkingã€‚å¯¹äºä»£ä»·å‡½æ•°åœ¨æŸä¸ªç‚¹å¯¼æ•°å¯è¿‘ä¼¼ä¸º:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mstyle displaystyle="true">
    <mfrac>
      <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
      <mrow>
        <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
        <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
      </mrow>
    </mfrac>
  </mstyle>
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
  <mo stretchy="false">)</mo>
  <mo>&#x2248;<!-- â‰ˆ --></mo>
  <mstyle displaystyle="true">
    <mfrac>
      <mrow>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        <mo>+</mo>
        <mi>&#x03F5;<!-- Ïµ --></mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>&#x03F5;<!-- Ïµ --></mi>
        <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
        <mn>2</mn>
        <mi>&#x03F5;<!-- Ïµ --></mi>
      </mrow>
    </mfrac>
  </mstyle>
</math>

<p>ä¸Šé¢å¼å­æ˜¯å•ä¸ªÎ˜çŸ©é˜µçš„æ¢¯åº¦è¿‘ä¼¼ï¼Œå¯¹äºè¿‡ä¸ªÎ˜çŸ©é˜µçš„æ¢¯åº¦è¿‘ä¼¼ï¼Œè®¡ç®—æ–¹æ³•ç›¸åŒ:</p>

<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
  <mstyle displaystyle="true">
    <mfrac>
      <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
      <mrow>
        <mi mathvariant="normal">&#x2202;<!-- âˆ‚ --></mi>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mi>j</mi>
        </msub>
      </mrow>
    </mfrac>
  </mstyle>
  <mi>J</mi>
  <mo stretchy="false">(</mo>
  <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
  <mo stretchy="false">)</mo>
  <mo>&#x2248;<!-- â‰ˆ --></mo>
  <mstyle displaystyle="true">
    <mfrac>
      <mrow>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- â€¦ --></mo>
        <mo>,</mo>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mi>j</mi>
        </msub>
        <mo>+</mo>
        <mi>&#x03F5;<!-- Ïµ --></mi>
        <mo>,</mo>
        <mo>&#x2026;<!-- â€¦ --></mo>
        <mo>,</mo>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mi>n</mi>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>J</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mn>1</mn>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- â€¦ --></mo>
        <mo>,</mo>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mi>j</mi>
        </msub>
        <mo>&#x2212;<!-- âˆ’ --></mo>
        <mi>&#x03F5;<!-- Ïµ --></mi>
        <mo>,</mo>
        <mo>&#x2026;<!-- â€¦ --></mo>
        <mo>,</mo>
        <msub>
          <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi>
          <mi>n</mi>
        </msub>
        <mo stretchy="false">)</mo>
      </mrow>
      <mrow>
        <mn>2</mn>
        <mi>&#x03F5;<!-- Ïµ --></mi>
      </mrow>
    </mfrac>
  </mstyle>
</math>

<p>ä¸ºäº†ä¿è¯è®¡ç®—ç»“æœç›¸è¿‘ï¼Œå…¶ä¸­<math><mi>Ïµ</mi><mo>=</mo><msup><mn>10</mn><mi>(-4)</mi></msup></math>ï¼Œæ³¨æ„è¿‡å°çš„Ïµä¼šå¯¼è‡´è®¡ç®—é—®é¢˜ï¼Œç”±äºæˆ‘ä»¬åªèƒ½å¯¹ä¸€ä¸ªÎ˜çŸ©é˜µè¿›è¡ŒÏµçš„åŠ å‡ï¼Œå¯¹äºå¤šä¸ªÎ˜çŸ©é˜µï¼Œåœ¨Octaveä¸­éœ€è¦ä½¿ç”¨å¾ªç¯è®¡ç®—</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">,</span>
  <span class="n">thetaPlus</span> <span class="o">=</span> <span class="n">theta</span><span class="p">;</span>
  <span class="n">thetaPlus</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+=</span> <span class="n">epsilon</span><span class="p">;</span>
  <span class="n">thetaMinus</span> <span class="o">=</span> <span class="n">theta</span><span class="p">;</span>
  <span class="n">thetaMinus</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-=</span> <span class="n">epsilon</span><span class="p">;</span>
  <span class="n">gradApprox</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">thetaPlus</span><span class="p">)</span> <span class="o">-</span> <span class="n">J</span><span class="p">(</span><span class="n">thetaMinus</span><span class="p">))/(</span><span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</code></pre></div></div>

<p>å¾—åˆ°è¿‘ä¼¼çš„æ¢¯åº¦ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†è®¡ç®—å¾—åˆ°çš„<code class="highlighter-rouge">Appprox</code>å’Œä¸Šä¸€èŠ‚çš„<code class="highlighter-rouge">deltaVector</code>è¿›è¡Œæ¯”è¾ƒï¼ŒæŸ¥çœ‹æ˜¯å¦<code class="highlighter-rouge">gradApprox â‰ˆ deltaVector</code>ï¼Œç”±äºè®¡ç®—<code class="highlighter-rouge">Approx</code>ä»£ä»·å¾ˆå¤§ï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œä¸€èˆ¬åœ¨ç¡®è®¤äº†BPç®—æ³•æ­£ç¡®åï¼Œå°±ä¸åœ¨è®¡ç®—<code class="highlighter-rouge">Appox</code>äº†</p>

<p>ç»“åˆå‰ä¸€èŠ‚åšä¸€ä¸ªç®€å•çš„æ€»ç»“:</p>

<ol>
  <li>é€šè¿‡å®ç°BPç®—æ³•å¾—åˆ°Î´çŸ©é˜µ<code class="highlighter-rouge">DVec</code>ï¼ˆUnrolled <math><msup><mi>D</mi><mi>(1)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(2)</mi></msup></math>ï¼Œ<math><msup><mi>D</mi><mi>(3)</mi></msup></math>ï¼‰</li>
  <li>è¿›è¡Œæ¢¯åº¦æ£€æŸ¥ï¼Œè®¡ç®—<code class="highlighter-rouge">gradApprox</code></li>
  <li>ç¡®ä¿è®¡ç®—ç»“æœè¶³å¤Ÿç›¸è¿‘</li>
  <li>åœæ­¢æ¢¯åº¦æ£€æŸ¥ï¼Œä½¿ç”¨BPå¾—åˆ°çš„ç»“æœ</li>
  <li>ç¡®ä¿åœ¨ç”¨ç¥ç»ç½‘ç»œè®­ç»ƒæ•°æ®çš„æ—¶å€™æ¢¯åº¦æ£€æŸ¥æ˜¯å…³é—­çš„ï¼Œå¦åˆ™ä¼šéå¸¸è€—æ—¶</li>
</ol>

<p>###Random Initialization</p>

<p>è®¡ç®—ç¥ç»ç½‘ç»œï¼Œå°†thetaåˆå§‹å€¼è®¾ä¸º0ä¸åˆé€‚ï¼Œè¿™ä¼šå¯¼è‡´åœ¨è®¡ç®—BPç®—æ³•çš„è¿‡ç¨‹ä¸­æ‰€æœ‰èŠ‚ç‚¹è®¡ç®—å‡ºçš„å€¼ç›¸åŒã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨éšæœºçš„æ–¹å¼äº§ç”ŸÎ˜çŸ©é˜µï¼Œæ¯”å¦‚å°†<math><msubsup><mi>Î˜</mi><mi>ij</mi><mi>(l)</mi></msubsup></math>åˆå§‹åŒ–èŒƒå›´æ§åˆ¶åœ¨[-Ïµ,Ïµ]ï¼š</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Theta1</span><span class="o">=</span><span class="nb">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">INIT_EPSILON</span><span class="p">)</span><span class="o">-</span><span class="n">INIT_EPSILON</span> <span class="err">#åˆå§‹åŒ–</span><span class="mi">10</span><span class="n">x11</span><span class="err">çš„çŸ©é˜µ</span>
<span class="n">Theta1</span><span class="o">=</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">INIT_EPSILON</span><span class="p">)</span><span class="o">-</span><span class="n">INIT_EPSILON</span> <span class="err">#åˆå§‹åŒ–</span><span class="mi">1</span><span class="n">x11</span><span class="err">çš„çŸ©é˜µ</span>
</code></pre></div></div>

<p>rand(x,y)å‡½æ•°ä¼šä¸ºçŸ©é˜µåˆå§‹åŒ–ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„å®æ•°ï¼Œä¸Šé¢çš„INIT_EPSILONå’Œä¸Šä¸€èŠ‚æåˆ°çš„Ïµä¸æ˜¯ä¸€ä¸ªÏµã€‚</p>

<h3 id="å°ç»“">å°ç»“</h3>

<p>è¿™ä¸€ç« å…ˆä»‹ç»äº†å¦‚ä½•æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…å«å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤</p>

<ul>
  <li>ç¬¬ä¸€å±‚è¾“å…¥å•å…ƒçš„ä¸ªæ•° = æ ·æœ¬<math xmlns="http://www.w3.org/1998/Math/MathML"> <msup> <mi>x</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>i</mi> <mo stretchy="false">)</mo> </mrow> </msup> </math>çš„ç»´åº¦</li>
  <li>æœ€åä¸€å±‚è¾“å‡ºå•å…ƒçš„ä¸ªæ•° = é¢„æµ‹ç»“æœåˆ†ç±»çš„ä¸ªæ•°</li>
  <li>Hidden Layerçš„ä¸ªæ•°= é»˜è®¤ä¸º1ä¸ªï¼Œå¦‚æœæœ‰å¤šä½™1ä¸ªçš„hidden layerï¼Œé€šå¸¸æ¯å±‚çš„unitä¸ªæ•°ç›¸åŒï¼Œç†è®ºä¸Šå±‚æ•°è¶Šå¤šè¶Šå¥½</li>
</ul>

<p>æ¥ä¸‹æ¥ä»‹ç»äº†å¦‚ä½•è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œï¼ŒåŒ…å«å¦‚ä¸‹å‡ æ­¥</p>

<ol>
  <li>éšæœºåˆå§‹åŒ–Î˜çŸ©é˜µ</li>
  <li>å®ç°FPç®—æ³•ï¼Œå¯¹ä»»æ„<math xmlns="http://www.w3.org/1998/Math/MathML"> <msup> <mi>x</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>i</mi> <mo stretchy="false">)</mo> </mrow> </msup> </math>å¾—å‡ºé¢„æµ‹å‡½æ•°<math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>h</mi> <mi mathvariant="normal">&#x0398;<!-- Î˜ --></mi> </msub> <mo stretchy="false">(</mo> <msup> <mi>x</mi> <mrow class="MJX-TeXAtom-ORD"> <mo stretchy="false">(</mo> <mi>i</mi> <mo stretchy="false">)</mo> </mrow> </msup> <mo stretchy="false">)</mo> </math></li>
  <li>å®ç°ä»£ä»·å‡½æ•°</li>
  <li>ä½¿ç”¨BPç®—æ³•å¯¹ä»£ä»·å‡½æ•°æ±‚åå¯¼ï¼Œå¾—åˆ°<math><mstyle displaystyle="true"><mfrac><mi>âˆ‚</mi><mrow><mi>âˆ‚</mi><msubsup><mi>Î˜</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mi>J</mi><mo stretchy="false">(</mo><mi>Î˜</mi><mo stretchy="false">)</mo></math>çš„ç®—å¼</li>
  <li>ä½¿ç”¨æ¢¯åº¦æ£€æŸ¥ï¼Œç¡®ä¿BPç®—å‡ºçš„Î˜çŸ©é˜µç»“æœæ­£ç¡®ï¼Œç„¶ååœæ­¢æ¢¯åº¦æ£€æŸ¥</li>
  <li>ä½¿ç”¨æ¢¯åº¦ä¸‹é™æˆ–è€…å…¶å®ƒé«˜çº§ä¼˜åŒ–ç®—æ³•æ±‚è§£æƒé‡çŸ©é˜µÎ˜ï¼Œä½¿ä»£ä»·å‡½æ•°çš„å€¼æœ€å°</li>
</ol>

<p>ä¸è®ºæ˜¯æ±‚è§£FPè¿˜æ˜¯BPç®—æ³•ï¼Œéƒ½è¦loopæ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">,</span>
   <span class="n">Perform</span> <span class="n">forward</span> <span class="n">propagation</span> <span class="nb">and</span> <span class="n">backpropagation</span> <span class="n">using</span> <span class="n">example</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
   <span class="p">(</span><span class="n">Get</span> <span class="n">activations</span> <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="nb">and</span> <span class="n">delta</span> <span class="n">terms</span> <span class="n">d</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="k">...</span><span class="c">,L</span>
</code></pre></div></div>

<p>BPæ¢¯åº¦ä¸‹é™çš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>

<p><img src="/assets/images/2017/09/ml-6-16.png" alt="" /></p>

<p>å†å›å¿†ä¸€ä¸‹æ¢¯åº¦ä¸‹é™ï¼Œå‡½æ•°åœ¨æå€¼ç‚¹å¤„çš„å¯¼æ•°</p>

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://www.coursera.org/learn/machine-learning">Machine Learning</a></li>
  <li><a href="https://classroom.udacity.com/courses/ud188">Deep Learning with PyTorch</a></li>
</ul>
:ET